"use strict";(self["webpackChunkArogs"]=self["webpackChunkArogs"]||[]).push([[171],{58984:function(t,e,s){s.r(e),s.d(e,{default:function(){return m}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"merchantSettled",attrs:{id:"merchantSettled"}},[e("div",{staticClass:"merchantSettled-wap"},[e("div",{staticClass:"step-div"},[e("van-popup",{attrs:{"close-on-click-overlay":!1,"get-container":"body"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[e("div",{staticClass:"content popup_content"},[e("div",{staticClass:"tc_wrap",on:{scroll:t.handleScroll}},[e("div",{ref:"capture",staticClass:"tc",attrs:{id:"originHtml"}},[e("p",{staticClass:"title"},[t._v(t._s(t.$t("capture_tit")))]),e("p",{staticClass:"padding-tb"},[t._v(" "+t._s(t.$t("capture_info"))+" ")]),e("p",{staticClass:"padding-tb"},[t._v(t._s(t.$t("capture_info1")))]),e("p",{staticClass:"padding-tb"},[t._v(t._s(t.$t("capture_info2")))]),e("p",[t._v(" "+t._s(t.$t("capture_info3"))+" ")]),e("p",[t._v(" "+t._s(t.$t("capture_info4"))+" ")]),e("p",[t._v(t._s(t.$t("capture_info5")))]),e("p",[t._v(" "+t._s(t.$t("capture_info6"))+" ")]),e("p",[t._v(" "+t._s(t.$t("capture_info7"))+" ")]),e("p",{staticClass:"padding-tb"},[t._v(t._s(t.$t("capture_info8")))]),e("p",[t._v(" "+t._s(t.$t("capture_info9"))+" ")]),e("p",[t._v(" "+t._s(t.$t("capture_info10"))+" ")]),e("p",[t._v(" "+t._s(t.$t("capture_info11",{time:"Argos"==t.itemname?"72":42}))+" ")]),e("p",{staticClass:"padding-tb"},[t._v(t._s(t.$t("capture_info12")))]),e("p",[t._v(" "+t._s(t.$t("capture_info13"))+" ")]),e("p",[t._v(" "+t._s(t.$t("capture_info14"))+" ")]),e("p",[t._v(" "+t._s(t.$t("capture_info15"))+" ")]),e("p",[t._v(t._s(t.$t("capture_info16")))]),e("div",{staticClass:"esign-content"},[e("div",[e("p",{staticClass:"padding-tb"},[t._v(" "+t._s(t.$t("capture_info17"))+" "),e("span",[t._v(t._s(t.itemname))]),e("img",{attrs:{src:s(10225)}})]),e("p",{staticClass:"padding-tb"},[t._v(" "+t._s(t.$t("capture_info19"))+t._s(t.now_date)+" ")])]),e("div",{staticClass:"right"},[e("p",{staticClass:"padding-tb"},[t._v(" "+t._s(t.$t("capture_info18"))),e("img",{staticClass:"esign-img",attrs:{src:t.resultImg}})]),e("p",{staticClass:"padding-tb"},[t._v(" "+t._s(t.$t("capture_info19"))+t._s(t.now_date)+" ")])])])])]),e("van-popup",{staticClass:"esign-container",attrs:{"close-on-click-overlay":!1,"get-container":"#app"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("vue-esign",{ref:"esign",staticClass:"sign-view",attrs:{width:800,height:300,isCrop:t.isCrop,lineWidth:t.lineWidth,lineColor:t.lineColor,bgColor:t.bgColor},on:{"update:bgColor":function(e){t.bgColor=e},"update:bg-color":function(e){t.bgColor=e}}}),e("div",{staticClass:"btn-list"},[e("div",{staticClass:"btn-left"},[e("van-button",{attrs:{type:"warning"},on:{click:t.reset}},[t._v(t._s(t.$t("重置")))]),e("van-button",{attrs:{type:"warning"},on:{click:t.goback}},[t._v(t._s(t.$t("返回上一步")))])],1),e("van-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v(t._s(t.$t("确认")))])],1)],1),e("div",{staticClass:"pop-bnt"},[e("van-button",{staticClass:"button",attrs:{type:"primary",disabled:t.scrollDisbled},on:{click:t.agreement}},[t._v(t._s(t.$t("同意并签名")))]),e("van-button",{staticClass:"button",attrs:{type:"primary",disabled:t.tjbtn},on:{click:t.argeementEsign}},[t._v(t._s(t.$t("确认")))])],1)],1)])],1)])])},a=[],n=(s(37850),s(88848)),o=(s(82801),s(48675),s(3462),s(37380),s(1118),s(89158)),l=s(65100),r=s(92269),c=s.n(r),d=s(21164),h=s(15941),p={name:"merchantSettled",data(){return{lineWidth:6,lineColor:"#000000",bgColor:"",resultImg:"",isCrop:!1,visible:!1,itemname:"",showPassword:!0,showPassword2:!0,tjbtn:!0,isCutting:!1,showUpLoader:!0,step:2,show:!0,checked:!1,screenWidth:document.body.clientWidth,signPdfUrl:"",token:"",pageDiaCode:!0,renderComponent:!0,blob:null,now_date:""}},computed:{isOverSize(){return 4096e3},isPC(){let t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],s=!0;for(let i=0;i<e.length;i++)if(t.indexOf(e[i])>0){s=!1;break}return s}},components:{vueEsign:l.Z},created(){this.screenWidth>=500?this.labelPosition="left":this.labelPosition="top",this.$route.query.usercode&&(localStorage.setItem("usercode",this.$route.query.usercode),this.ruleForm.usercode=this.$route.query.usercode),this.isPC&&(this.scrollDisbled=!1),this.getNowFormatDate()},mounted(){this.token=sessionStorage.getItem("SellToken"),this.itemname=sessionStorage.getItem("itemName"),h.log("this.name ->",this.itemname)},methods:{uploadSign(){h.log("this.signPdfUrl ->",this.signPdfUrl),(0,o.ws)({token:this.token,signPdfUrl:this.signPdfUrl+""}).then((t=>{h.log("res ->",t),"success"==t?((0,n.Z)(this.$t("成功")),setTimeout((()=>{window.top.closePopup&&window.top.closePopup()}),1e3)):(0,n.Z)(this.$t("失败"))}))},reset(){this.$refs.esign.reset()},goback(){this.$refs.esign.reset(),this.visible=!1},getNowFormatDate(){let t=new Date,e=t.getFullYear(),s=t.getMonth()+1,i=t.getDate();s<10&&(s=`0${s}`),i<10&&(i=`0${i}`),this.now_date=`${e}-${s}-${i}`},save(){this.$refs.esign.generate({format:"image/jpeg",quality:.5}),this.$refs.esign.generate().then((t=>{this.resultImg=t,this.visible=!1,setTimeout((()=>{this.getImg()}),2e3)})).catch((t=>{(0,n.Z)(this.$t("请签字后再提交"))}))},argeementEsign(){this.signPdfUrl?this.uploadSign():(0,n.Z)(this.$t("请签字后再提交"))},dataURLtoBlob(t){let e=t.split(","),s=e[0].match(/:(.*?);/)[1],i=atob(e[1]),a=i.length,n=new Uint8Array(a);while(a--)n[a]=i.charCodeAt(a);return new Blob([n],{type:s})},blobToFile(t,e){return t.lastModifiedDate=new Date,t.name=e,t},convertBase64ToFile(t,e){var s=t.split("base64,"),i=s[0].match(/:(.*?);/)[1],a=i.split("/")[1],n=atob(s[1]),o=n.length,l=new Uint8Array(o);while(o--)l[o]=n.charCodeAt(o);return new File([l],e+"."+a,{type:i})},getImg(){this.$refs.capture.scrollTop=0,c()(this.$refs.capture,{allowTaint:!0,useCORS:!0}).then((t=>{let e=t.width,s=t.height,i=e/592.28*841.89,a=s,l=0,r=595.28,c=592.28/e*s,p=t.toDataURL("image/jpeg",1),g=new d.ZP("","pt","a4");if(a<i)g.addImage(p,"JPEG",10,0,r,c);else while(a>0)g.addImage(p,"JPEG",10,l,r,c),a-=i,l-=841.89,a>0&&g.addPage();this.tjbtn=!0;let u=this.convertBase64ToFile(g.output("dataurlstring"),"esign.pdf");h.log("blob ->",u);let _=new File([u],"esign.pdf"),m=new FormData;m.append("file",_),m.append("moduleName","seller"),n.Z.loading({duration:0,message:this.$t("上传中"),forbidClick:!0}),(0,o.VU)(m).then((t=>{this.signPdfUrl=t,this.tjbtn=!1,(0,n.Z)(this.$t("签名成功"))})).catch((function(){n.Z.clear(),(0,n.Z)(this.$t("失败")),this.signPdfUrl=""}))}))},handleScroll(t){const{scrollTop:e,clientHeight:s,scrollHeight:i}=t.target;h.log(e,s,i),e+s+2>=i&&(this.scrollDisbled=!1)},open(){1==this.checked&&(this.checked=!1),this.checked=!1,0==this.checked&&(this.show=!0)},agreement(){this.visible=!0},closeAgreement(){this.show=!1,this.checked=!1},onOversize(t){h.log(t),(0,n.Z)(this.$t("文件大小不能超过 4Mb"))},handleCutting(){this.isCutting=!0},handleCancel(){this.isCutting=!1,this.fileList1=[]},handleUpload(t){let e=new File([t],"logo.png");this.isCutting=!1,n.Z.loading({duration:0,message:this.$t("上传中"),forbidClick:!0});let s=new FormData;s.append("file",e),s.append("moduleName","selle"),(0,o.VU)(s).then((t=>{n.Z.clear(),this.ruleForm.sellerImg=t,h.log("data ->",t),this.fileList1[0].content=t})).catch((function(){n.Z.clear(),(0,n.Z)(this.$t("失败")),this.fileList1=[]}))},updateMerchantInfo(t){this.ruleForm.sellerImg=t},handleCropData(t){h.log("裁剪数据"),h.log(t)},handleSetLang(t){h.log(t),this.$i18n.locale=this.lang[t].key,this.setLanguage(this.lang[t].key)},changeCountry(t){h.log(t),this.ruleForm.country=t},goPage(){var t;null!==(t=window)&&void 0!==t&&t.plus?window.open(window.origin+"/www","_self"):(this.pc,window.open("https://"+window.location.hostname+"/ww"))},stepFun(){this.checked?(this.step=2,this.$el.querySelector("#product").scrollIntoView({behavior:"smooth"})):(0,n.Z)(this.$t("请同意入驻协议"))},paperworkAfterRead(t,e){h.log("fileIndex ->",e);const s=this;n.Z.loading({duration:0,message:s.$t("上传中"),forbidClick:!0});let i=new FormData;i.append("file",t.file),i.append("moduleName","selle"),(0,o.VU)(i).then((t=>{n.Z.clear(),s.ruleForm[`idimg_${e}`]=t})).catch((()=>{n.Z.clear(),(0,n.Z)(s.$t("失败")),s[`fileList${e+1}`]=[]})),0==e&&(0,o.VU)(i).then((t=>{n.Z.clear(),(0,n.Z)(s.$t("成功")),s.ruleForm.sellerImg=t})).catch((()=>{n.Z.clear(),(0,n.Z)(s.$t("失败")),s.ruleForm.sellerImg=[]}))}},beforeDestroy(){n.Z.clear()}},g=p,u=s(1001),_=(0,u.Z)(g,i,a,!1,null,"076e849c",null),m=_.exports}}]);