import{_ as A,h as D,g as P,u as R,ai as $,j as z,r as c,m as E,k as H,I as M,c as b,e as f,w as x,a,t as l,b as s,q as w,f as m,n as q,T as p,ck as Q,b1 as G,o as C,cl as J,F as K,P as O,Q as W}from"./index-7648d0ea.js";import{B as X}from"./index-142fa497.js";import"./index-4d9d1ef2.js";import{F as Y}from"./index-1b0845c1.js";import{a as Z}from"./login.api-af0f9d44.js";import"./use-id-47fe37c4.js";const ee=h=>(O("data-v-815bbfd7"),h=h(),W(),h),se={class:"verify-content"},te=ee(()=>a("div",{style:{height:"46px"}},null,-1)),ae={class:"info-content"},oe={class:"info-item"},ne={class:"gap"},le={class:"info-item"},re={class:"gap"},ue={key:0},ie={class:"change-ver-type"},ce={class:"submit-content"},de={__name:"index",setup(h){const v=D(),I=P(),{t:e}=R(),d=$(),V=z(),n=c(1),k=c(1),S=c("44"),y=c(""),u=c(0),_=c(null),g=c(!1);n.value=d.query&&d.query.type?Number(d.query.type):1,k.value=d.query&&d.query.verType?Number(d.query.verType):1,E(()=>{clearInterval(_.value),_.value=null});const N=H(()=>{if(!v.userInfo.token)V.push("/login");else{const{email:r,phone:o}=v.userInfo;let t="";if(n.value===1){if(o){const i=o.split(" ");i.length===2?(S.value=i[0],t=i[1]):t=i[0]}}else t=r||"";return t}}),B=()=>{if(u.value>0)return!1;const{email:r,phone:o}=v.userInfo;p.loading({duration:0,forbidClick:!0}),Z({target:n.value===1?o:r}).then(()=>{p(e("sendSuccess")),u.value=60,_.value=setInterval(()=>{u.value>0?u.value=u.value-1:(u.value=0,clearInterval(_.value),_.value=null)},1e3)}).catch(()=>{p.clear()})},F=()=>{const{email:r,phone:o}=v.userInfo,t=n.value===1?2:1;if(t===2&&!r)return p(e("\u6682\u672A\u7ED1\u5B9A\u90AE\u7BB1\uFF0C\u65E0\u6CD5\u8FDB\u884C\u90AE\u7BB1\u9A8C\u8BC1")),!1;if(t===1&&!o)return p(e("\u6682\u672A\u7ED1\u5B9A\u624B\u673A\u53F7\uFF0C\u65E0\u6CD5\u8FDB\u884C\u624B\u673A\u9A8C\u8BC1")),!1;n.value=t},U=()=>{if(y.value===""){p(e("entryVerifyCode"));return}g.value=!0;const{email:r,phone:o}=v.userInfo,t={target:n.value===1?o:r,verifcode:y.value};n.value===1?t.phone=o:t.email=r,Q(t).then(i=>{g.value=!1,V.push(`/bindVerify?type=${k.value}&reset=1&verifyCode=${i.verifyCode}`)}).catch(()=>{g.value=!1})};return(r,o)=>{const t=G,i=Y,T=X,L=M;return C(),b("div",se,[f(t,{fixed:!0},{title:x(()=>[m(l(s(e)("\u8EAB\u4EFD\u9A8C\u8BC1")),1)]),_:1}),te,a("div",ae,[a("div",oe,[a("h2",ne,l(n.value===1?s(e)("\u624B\u673A\u9A8C\u8BC1"):s(e)("\u90AE\u7BB1\u9A8C\u8BC1")),1),a("p",null,l(s(e)("\u4E3A\u4E86\u4FDD\u969C\u60A8\u7684\u8D26\u53F7\u5B89\u5168\uFF0C\u8BF7\u9A8C\u8BC1\u540E\u8FDB\u884C\u4E0B\u4E00\u6B65\u64CD\u4F5C")),1)]),a("div",le,[a("p",re,l(n.value===1?s(e)("\u5F53\u524D\u7ED1\u5B9A\u624B\u673A\u53F7"):s(e)("\u5F53\u524D\u7ED1\u5B9A\u90AE\u7BB1")),1),a("h2",null,[n.value===1?(C(),b("span",ue,"(+"+l(S.value)+")",1)):w("v-if",!0),m(l(s(J)(s(N),!1)),1)])]),a("div",{class:q(["code-content",{"is-ar":s(I)}])},[f(i,{modelValue:y.value,"onUpdate:modelValue":o[0]||(o[0]=j=>y.value=j),type:"tel",label:"",placeholder:s(e)("entryVerifyCode")},null,8,["modelValue","placeholder"]),a("div",{class:q(["btn",{"is-ar":s(I)}])},[f(T,{type:"primary",onClick:B},{default:x(()=>[m(l(s(e)("sendVerifyCode")),1),u.value?(C(),b(K,{key:0},[m("("+l(u.value)+")s",1)],64)):w("v-if",!0)]),_:1})],2)],2),a("div",ie,[f(L,{name:"exchange"}),a("p",{onClick:F},l(n.value===1?s(e)("\u5207\u6362\u4E3A\u90AE\u7BB1\u9A8C\u8BC1"):s(e)("\u5207\u6362\u4E3A\u624B\u673A\u9A8C\u8BC1")),1)])]),a("div",ce,[f(T,{type:"primary",loading:g.value,onClick:U},{default:x(()=>[m(l(s(e)("nextStep")),1)]),_:1},8,["loading"])])])}}},ye=A(de,[["__scopeId","data-v-815bbfd7"],["__file","/Users/wangjun/Downloads/mall-app-h5/src/views/verifyPage/index.vue"]]);export{ye as default};
