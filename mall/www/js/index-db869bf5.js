import{_ as N,u as P,j as C,h as j,k as x,r as i,S as F,c as W,e as l,w,a as u,b as f,aW as q,t as g,T as v,cC as A,cD as E,b1 as H,o as K,f as y,P as L,Q as O}from"./index-b92e7abb.js";import{A as R}from"./index-07a8fa62.js";import{P as z,N as Q}from"./index-b73fdc3e.js";import{B as G}from"./index-2daf6026.js";import"./index-7a2fbf58.js";import{F as J}from"./index-5c15dc0a.js";import{_ as M}from"./index-21f45b06.js";import{D as X}from"./function-call-89204d76.js";import"./use-id-ae9dfb84.js";const Y=p=>(L("data-v-d91fc208"),p=p(),O(),p),Z=Y(()=>u("div",{style:{height:"46px"}},null,-1)),ee={class:"cancellation-content"},ae={class:"item"},oe={class:"item"},se={class:"btn"},te={style:{height:"22rem"}},ne={__name:"index",setup(p){const{t:o}=P(),S=C(),_=j(),r=x(()=>{let e={username:"***",safeword:0};return _.userInfo.token?e={...e,..._.userInfo}:S.push("/login"),e}),h=x(()=>{const e=r.value.username;if(r.value.username.indexOf("@")>-1)return e;if(r.value.phone){const a=r.value.phone.split(" ");return`(+${a[0]}) ${a[1]}`}else return e}),d=i(!1),m=i(""),t=i(""),n=i(!1),B=async()=>{if(!m.value)return v(o("\u8BF7\u8F93\u5165\u60A8\u8981\u6CE8\u9500\u8D26\u53F7\u7684\u539F\u56E0")),!1;n.value=!0;const e=await A();e.money=0,n.value=!1,e.money>0?v(o("\u8BE5\u8D26\u53F7\u5B58\u5728\u53EF\u7528\u4F59\u989D\uFF0C\u4E0D\u53EF\u6CE8\u9500\uFF01")):Boolean(r.value.safeword)?(d.value=!0,c.value=!0):V()},V=async()=>{n.value=!0,d.value=!1,c.value=!1,X.confirm({title:o("\u60A8\u786E\u8BA4\u8981\u6CE8\u9500\u5417\uFF1F"),message:o("\u8B66\u544A\uFF01\u8BF7\u8C28\u614E\u64CD\u4F5C\u6CE8\u9500\u8D26\u6237\uFF0C\u5982\u679C\u60A8\u4E0D\u518D\u4F7F\u7528\u8BE5\u8D26\u53F7\uFF0C\u53EF\u70B9\u51FB\u3010\u540C\u610F\u6CE8\u9500\u3011\uFF0C\u6CE8\u9500\u540E\u53EF\u80FD\u51E0\u5929\u5185\u65E0\u6CD5\u6CE8\u518C\u3002"),confirmButtonColor:"#ee0a24",cancelButtonText:o("cancel"),confirmButtonText:o("\u540C\u610F\u6CE8\u9500")}).then(()=>{b()}).catch(()=>{n.value=!1})},b=()=>{const e={account:r.value.username,reason:m.value,cashPassword:t.value||null};E(e).then(()=>{n.value=!1,v.success(o("\u6CE8\u9500\u6210\u529F")),setTimeout(()=>{_.logout()},1500)}).catch(()=>{t.value="",n.value=!1})},c=i(!1);return F(()=>t.value,e=>{e.length===6&&(v.loading(""),b(),d.value=!1,t.value="")}),(e,a)=>{const I=H,k=J,T=G,U=z,$=Q,D=R;return K(),W("div",null,[l(I,{fixed:""},{title:w(()=>[y(g(f(o)("\u8D26\u53F7\u6CE8\u9500")),1)]),_:1}),Z,u("div",ee,[u("div",ae,[l(M,{label:e.$t("\u60A8\u7684\u8D26\u53F7"),modelValue:f(h),"onUpdate:modelValue":a[0]||(a[0]=s=>q(h)?h.value=s:null),disabled:!0,clearBtn:!1,typeText:"text"},null,8,["label","modelValue"])]),u("div",oe,[u("p",null,g(f(o)("\u4E3A\u4EC0\u4E48\u8981\u79BB\u5F00\uFF1F")),1),l(k,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=s=>m.value=s),rows:"4",autosize:"",type:"textarea",placeholder:f(o)("pleaseEnter")},null,8,["modelValue","placeholder"])]),u("div",se,[l(T,{type:"danger",loading:n.value,block:"",onClick:B},{default:w(()=>[y(g(e.$t("\u6CE8\u9500\u8D26\u53F7")),1)]),_:1},8,["loading"])])]),l(D,{show:d.value,"onUpdate:show":a[5]||(a[5]=s=>d.value=s),title:f(o)("\u8BF7\u8F93\u5165\u4EA4\u6613\u5BC6\u7801")},{default:w(()=>[u("div",te,[l(U,{length:6,value:t.value,focused:c.value,onFocus:a[2]||(a[2]=s=>c.value=!0)},null,8,["value","focused"]),l($,{modelValue:t.value,"onUpdate:modelValue":a[3]||(a[3]=s=>t.value=s),show:c.value,onBlur:a[4]||(a[4]=s=>c.value=!1)},null,8,["modelValue","show"])])]),_:1},8,["show","title"])])}}},ve=N(ne,[["__scopeId","data-v-d91fc208"],["__file","/Users/wangjun/Downloads/mall-app-h5/src/views/setting/cancellation/index.vue"]]);export{ve as default};
