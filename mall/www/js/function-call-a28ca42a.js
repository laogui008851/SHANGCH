import{z as S,d as T,r as R,bw as M,aI as W,Y as x,e as a,K as D,A as g,B as Y,E as Z,a6 as q,k as A,a9 as V,bn as j,D as G,Z as J,C as Q,bp as X,l as ee,ag as K,aZ as te,a8 as ne,bq as oe,bx as ae,by as _,a4 as le,bv as se,bz as re,bh as ce,ba as ie,bA as ue,bB as de}from"./index-ddb6536b.js";import{B as O}from"./index-b0cd68f2.js";const[N,E]=S("action-bar"),$=Symbol(N),fe={placeholder:Boolean,safeAreaInsetBottom:x};var me=T({name:N,props:fe,setup(e,{slots:l}){const o=R(),r=M(o,E),{linkChildren:c}=W($);c();const m=()=>{var B;return a("div",{ref:o,class:[E(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[(B=l.default)==null?void 0:B.call(l)])};return()=>e.placeholder?r(m):m()}});const Be=D(me),[ge,be]=S("action-bar-button"),he=g({},Y,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var Ce=T({name:ge,props:he,setup(e,{slots:l}){const o=Z(),{parent:r,index:c}=q($),m=A(()=>{if(r){const i=r.children[c.value-1];return!(i&&"isButton"in i)}}),B=A(()=>{if(r){const i=r.children[c.value+1];return!(i&&"isButton"in i)}});return V({isButton:!0}),()=>{const{type:i,icon:b,text:h,color:y,loading:p,disabled:P}=e;return a(O,{class:be([i,{last:B.value,first:m.value}]),size:"large",type:i,icon:b,color:y,loading:p,disabled:P,onClick:o},{default:()=>[l.default?l.default():h]})}}});const I=D(Ce),[we,u,v]=S("dialog"),ve=g({},j,{title:String,theme:String,width:G,message:[String,Function],callback:Function,allowHtml:Boolean,className:J,transition:Q("van-dialog-bounce"),messageAlign:String,closeOnPopstate:x,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:x,closeOnClickOverlay:Boolean}),ye=[...X,"transition","closeOnPopstate"];var F=T({name:we,props:ve,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:l,slots:o}){const r=R(),c=ee({confirm:!1,cancel:!1}),m=t=>l("update:show",t),B=t=>{var s;m(!1),(s=e.callback)==null||s.call(e,t)},i=t=>()=>{!e.show||(l(t),e.beforeClose?(c[t]=!0,ce(e.beforeClose,{args:[t],done(){B(t),c[t]=!1},canceled(){c[t]=!1}})):B(t))},b=i("cancel"),h=i("confirm"),y=ae(t=>{var s,d;if(t.target!==((d=(s=r.value)==null?void 0:s.popupRef)==null?void 0:d.value))return;({Enter:e.showConfirmButton?h:_,Escape:e.showCancelButton?b:_})[t.key](),l("keydown",t)},["enter","esc"]),p=()=>{const t=o.title?o.title():e.title;if(t)return a("div",{class:u("header",{isolated:!e.message&&!o.default})},[t])},P=t=>{const{message:s,allowHtml:d,messageAlign:f}=e,w=u("message",{"has-title":t,[f]:f}),k=le(s)?s():s;return d&&typeof k=="string"?a("div",{class:w,innerHTML:k},null):a("div",{class:w},[k])},H=()=>{if(o.default)return a("div",{class:u("content")},[o.default()]);const{title:t,message:s,allowHtml:d}=e;if(s){const f=!!(t||o.title);return a("div",{key:d?1:0,class:u("content",{isolated:!f})},[P(f)])}},z=()=>a("div",{class:[re,u("footer")]},[e.showCancelButton&&a(O,{size:"large",text:e.cancelButtonText||v("cancel"),class:u("cancel"),style:{color:e.cancelButtonColor},loading:c.cancel,disabled:e.cancelButtonDisabled,onClick:b},null),e.showConfirmButton&&a(O,{size:"large",text:e.confirmButtonText||v("confirm"),class:[u("confirm"),{[se]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:c.confirm,disabled:e.confirmButtonDisabled,onClick:h},null)]),L=()=>a(Be,{class:u("footer")},{default:()=>[e.showCancelButton&&a(I,{type:"warning",text:e.cancelButtonText||v("cancel"),class:u("cancel"),color:e.cancelButtonColor,loading:c.cancel,disabled:e.cancelButtonDisabled,onClick:b},null),e.showConfirmButton&&a(I,{type:"danger",text:e.confirmButtonText||v("confirm"),class:u("confirm"),color:e.confirmButtonColor,loading:c.confirm,disabled:e.confirmButtonDisabled,onClick:h},null)]}),U=()=>o.footer?o.footer():e.theme==="round-button"?L():z();return()=>{const{width:t,title:s,theme:d,message:f,className:w}=e;return a(oe,K({ref:r,role:"dialog",class:[u([d]),w],style:{width:ne(t)},tabindex:0,"aria-labelledby":s||f,onKeydown:y,"onUpdate:show":m},te(e,ye)),{default:()=>[p(),H(),U()]})}}});let C;function pe(){({instance:C}=ue({setup(){const{state:l,toggle:o}=de();return()=>a(F,K(l,{"onUpdate:show":o}),null)}}))}function n(e){return ie?new Promise((l,o)=>{C||pe(),C.open(g({},n.currentOptions,e,{callback:r=>{(r==="confirm"?l:o)(r)}}))}):Promise.resolve()}n.defaultOptions={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};n.currentOptions=g({},n.defaultOptions);n.alert=n;n.confirm=e=>n(g({showCancelButton:!0},e));n.close=()=>{C&&C.toggle(!1)};n.setDefaultOptions=e=>{g(n.currentOptions,e)};n.resetDefaultOptions=()=>{n.currentOptions=g({},n.defaultOptions)};n.Component=D(F);n.install=e=>{e.use(n.Component),e.config.globalProperties.$dialog=n};export{n as D};
