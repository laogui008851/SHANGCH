import{_ as oe,ai as te,j as ae,u as le,r as l,h as se,m as ne,cs as ue,S as ie,L as re,c as y,e as c,w as T,a as o,q as m,t as n,M as ce,N as ve,f as A,F as de,b as pe,T as i,ct as me,cu as j,cv as fe,b1 as ge,o as C,P as _e,Q as he}from"./index-9fb53779.js";import{B as ye}from"./index-05040b60.js";import{P as Ae,N as Ce}from"./index-f5f2a1d9.js";import{_ as F}from"./index-1508c6b9.js";import{a as be}from"./login.api-1e9d9881.js";import{n as Ve}from"./nationalityList-bbeace68.js";import{u as we}from"./index-1b9a71ee.js";import{I as Se}from"./index-4c40d7c7.js";import"./index-661a407d.js";import"./index-c39de9e5.js";import"./use-id-1cc1e85b.js";import"./index-6059f935.js";import"./index-06fe3a80.js";import"./countryList-016fc82e.js";const Be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKzSURBVHgBvVZdbtpAEP5214G+VOUI9ATlBqEnKDlB4CVV1JeitJHSKIqjCJCaEsRDFYVUIj1BuEHICUJPUN+gPDY23unuEsjaQLDz00+yZHt29tud2Z35GFKi9vV7AYIXGHiOJHLg0pMS3t7nzX4Sf5Zk0OHRSdHhYp2AkvrM3TO0F8qwvYi80ep07yVsNE7ylHW6ICoiDQgDPwjX3J1NzyZTESnzRT714x/rlBHXC8iG6vFun1kwFDIZ8bvePP1ok41Nc9Bone2TJDdOov61QaPe7vaHgW0weWVOiXOmw563bcTYgBEV7tYSw+G305Jg7CLiRGgHYsV1q5UhlqB2dOoyzvYX2SOEOmfIiEt7lRSisru9cY4UqDVPygyiO88WzWFG7EdCIqmalsxMysXqItt0h+ZEqkRbhvOdrY0KUsI+IHMXM3khh5dsww0PD/DEZBFCVT3eTV717tzq3R16KrIooXXfJHCFFEhKpuGMHVT+pPU3DAZIgZu/JvyJUmAIRyPkhXVeiWf/IAXsErYMhsZxkNjhsTCEN3gRqSBEwWs8Ewzhbcka3v3kRTwTHOu9j3G/AxNsFU+EerNzobuHmZfQnx6VkOjndBShqJsuHglTm/UmSJVL9ejrNiXc+/S+Byusgouu2+rm8BioRmB9eQFf6UWKNyGsWp/5jPS7eCDqrbNWrBG09VmZ6Yf1486lDqm1jJ7vy2rSu+a63Vz2VdCKVR7vy9aGOfkzEsNnK2ssIh1YScmFy1qzU15GpvOefRlcx8l8Hr6dzjbPUZc6yGgjnjgrhz6BfoVSmvLHOfIMzhsViTJmFZ0hsxvBQtVm6mvIXTC2joeAWN8Xo0q86yzVpVoucMSUwP3w1NiD3a35SiGRENbQ+eFMlJRAeoOxCpuEb6h2o0joSlLYS6rA/xv+AZfLLFBKDLSAAAAAAElFTkSuQmCC";const ke=b=>(_e("data-v-59a3607d"),b=b(),he(),b),Ie={class:"bindVerify h-full bg-white"},Ee={class:"content"},Te={key:0},$e={style:{"margin-top":"22px"}},Ue={class:"label mt-2 textColor"},Ne={class:"iptbox inputBackground"},xe=["placeholder"],Pe={style:{"margin-top":"22px"}},Re={key:1},je={class:"pl-30 pr-30 text-center flex flex-col items-center justify-center mt40"},Fe={class:"imgbox"},Ge={class:"code flex items-center justify-center textColor"},He={class:"tips"},qe={class:"flex justify-between mt-6 mb-3"},De={class:"flex items-center"},Oe=ke(()=>o("div",{class:"mt-2"},null,-1)),ze={class:"mt-5 bottom tabBackground textColor"},Je={__name:"index",setup(b){const B=te(),$=ae(),{t:u}=le(),{toClipboard:G}=we(),V=l(""),s=l(""),f=l(""),U=l(!1),t=l(0),k=l(""),w=l(""),S=l(""),g=l(!1),v=l("");l(!0);const N=l(""),p=l(0),_=l(null),d=l(0),x=l(""),H=se(),h=l(!1);ne(()=>{console.log("ss"),q(),clearInterval(_.value),_.value=null});const q=()=>{t.value=B.query.type,k.value=B.query.verifyCode||"",t.value==1?(V.value=u("bindPhone"),U.value=!0):t.value==2?V.value=u("bindEmail"):t.value==3&&(V.value=u("googleAuthenticatorEn"),P())},D=async()=>{if(t.value==2&&s.value==""){i(u("entryEmail"));return}if(t.value==1&&s.value==""){i(u("entryPhone"));return}if(d.value>0)return!1;i.loading({mask:!0}),await me({target:t.value==1?`${p.value} ${s.value}`:s.value}),be({target:t.value==1?`${p.value} ${s.value}`:s.value}).then(e=>{i(u("sendSuccess")),d.value=30,_.value=setInterval(()=>{d.value>0?d.value=d.value-1:(d.value=0,clearInterval(_.value),_.value=null)},1e3)}).catch(()=>{i.clear()})},O=()=>{if(t.value==2&&s.value==""){i(u("entryEmail"));return}if(t.value==1&&s.value==""){i(u("entryPhone"));return}if(f.value==""){i(u("\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801"));return}h.value=!0,t.value==1?J():t.value==2?z():t.value==3&&X()},I=async()=>{await H.getUserInfo(!0),i(u("bindSuccess")),h.value=!1,setTimeout(()=>{B.query.reset?$.go(-2):$.back()},1e3)},z=()=>{j({target:s.value,email:s.value,verifcode:w.value,password:f.value,verifyCode:k.value}).then(e=>{I()}).catch(e=>{console.log(e),h.value=!1})},J=()=>{j({target:`${p.value} ${s.value}`,phone:`${p.value} ${s.value}`,verifcode:w.value,password:f.value,verifyCode:k.value}).then(e=>{I()}).catch(e=>{console.log(e),h.value=!1})},P=()=>{ue({}).then(e=>{S.value=e.google_auth_secret,N.value=e.google_auth_url,console.log(e)})},X=()=>{fe({secret:S.value,code:v.value}).then(e=>{e.google_auth_bind?I():i(err||u("bindFailed"))})},Y=async()=>{try{await G(S.value),i(u("copySuccess"))}catch(e){console.error(e)}},M=async()=>{v.value=await navigator.clipboard.readText()},Z=(e,a,E)=>{x.value=a,p.value=E},R=l(null),K=()=>{R.value.open()};return ie(v,(e,a)=>{v.value.length===6&&(g.value=!1)}),(e,a)=>{const E=ge,L=re,Q=Ae,W=Ce,ee=ye;return C(),y("div",Ie,[c(E,null,{title:T(()=>[A(n(V.value),1)]),_:1}),o("div",Ee,[m(" \u624B\u673A\u90AE\u7BB1\u9A8C\u8BC1 "),t.value==1||t.value==2?(C(),y("div",Te,[o("div",$e,[c(F,{label:t.value==2?e.$t("email"):e.$t("phoneNum"),placeholderText:t.value==2?e.$t("entryEmail"):e.$t("entryPhone"),modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=r=>s.value=r),area:U.value,onSelectArea:K,dialCode:p.value,icon:x.value},null,8,["label","placeholderText","modelValue","area","dialCode","icon"])]),o("p",Ue,n(e.$t("verificationCode")),1),o("div",Ne,[ce(o("input",{class:"inputBackground textColor",type:"text",placeholder:e.$t("entryVerifyCode"),"onUpdate:modelValue":a[1]||(a[1]=r=>w.value=r)},null,8,xe),[[ve,w.value]]),t.value!=3?(C(),y("span",{key:0,onClick:D},[A(n(e.$t("sendVerifyCode")),1),d.value?(C(),y(de,{key:0},[A(" ("+n(d.value)+")s",1)],64)):m("v-if",!0)])):m("v-if",!0)]),o("div",Pe,[c(F,{label:e.$t("\u767B\u5F55\u5BC6\u7801"),placeholderText:e.$t("\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801"),modelValue:f.value,"onUpdate:modelValue":a[2]||(a[2]=r=>f.value=r),typeText:"password",clearBtn:!1},null,8,["label","placeholderText","modelValue"])])])):m("v-if",!0),m(" \u8C37\u6B4C\u9A8C\u8BC1 "),t.value==3?(C(),y("div",Re,[o("div",je,[o("div",Fe,[c(pe(Se),{src:N.value},{loading:T(()=>[c(L,{type:"spinner",size:"20"})]),_:1},8,["src"])]),o("div",Ge,[A(n(S.value)+" ",1),o("img",{src:Be,alt:"",onClick:P})]),o("p",He,n(e.$t("saveKeyTips")),1),o("div",{class:"copy textColor",onClick:Y},n(e.$t("copy")),1)]),o("div",qe,[o("div",null,n(e.$t("googleVerificationCode")),1),o("div",De,[o("div",{class:"colorMain",onClick:a[3]||(a[3]=r=>v.value="")},n(e.$t("clear")),1),o("div",{class:"colorMain ml-30",onClick:M},n(e.$t("paste")),1)])]),c(Q,{value:v.value,gutter:16,focused:g.value,onFocus:a[4]||(a[4]=r=>g.value=!0),mask:!1},null,8,["value","focused"]),c(W,{modelValue:v.value,"onUpdate:modelValue":a[5]||(a[5]=r=>v.value=r),show:g.value,onBlur:a[6]||(a[6]=r=>g.value=!1)},null,8,["modelValue","show"]),Oe,o("div",ze,[o("p",null,n(e.$t("precautions")),1),o("p",null,n(e.$t("precautionsTips1")),1),o("p",null,n(e.$t("precautionsTips2")),1)])])):m("v-if",!0),c(ee,{class:"w-full",style:{"margin-top":"30px"},type:"primary",loading:h.value,onClick:O},{default:T(()=>[A(n(e.$t("confirm")),1)]),_:1},8,["loading"])]),c(Ve,{ref_key:"controlChildRef",ref:R,title:e.$t("selectArea"),onGetName:Z},null,8,["title"])])}}},no=oe(Je,[["__scopeId","data-v-59a3607d"],["__file","/Users/wangjun/Downloads/mall-app-h5/src/views/bindVerify/index.vue"]]);export{no as default};
