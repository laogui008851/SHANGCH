import{z as J,Y as z,D as L,a5 as E,d as Q,r as V,l as U,aD as ue,aI as re,k as f,a9 as j,S as x,aJ as ve,aK as fe,aL as de,m as q,au as he,aM as me,aN as ge,aO as we,ad as pe,e as P,aP as W,ac as F,aQ as A,J as ye,aR as _,K as G,a6 as be}from"./index-6bb60bad.js";const[Z,M]=J("swipe"),Se={loop:z,width:L,height:L,vertical:Boolean,autoplay:E(0),duration:E(500),touchable:z,lazyRender:Boolean,initialSwipe:E(0),indicatorColor:String,showIndicators:z,stopPropagation:z},ee=Symbol(Z);var Te=Q({name:Z,props:Se,emits:["change"],setup(a,{emit:C,slots:h}){const u=V(),d=V(),e=U({rect:null,width:0,height:0,offset:0,active:0,swiping:!1}),r=ue(),{children:m,linkChildren:k}=re(ee),i=f(()=>m.length),l=f(()=>e[a.vertical?"height":"width"]),s=f(()=>a.vertical?r.deltaY.value:r.deltaX.value),g=f(()=>e.rect?(a.vertical?e.rect.height:e.rect.width)-l.value*i.value:0),D=f(()=>Math.ceil(Math.abs(g.value)/l.value)),y=f(()=>i.value*l.value),I=f(()=>(e.active+i.value)%i.value),R=f(()=>{const t=a.vertical?"vertical":"horizontal";return r.direction.value===t}),te=f(()=>{const t={transitionDuration:`${e.swiping?0:a.duration}ms`,transform:`translate${a.vertical?"Y":"X"}(${e.offset}px)`};if(l.value){const o=a.vertical?"height":"width",n=a.vertical?"width":"height";t[o]=`${y.value}px`,t[n]=a[n]?`${a[n]}px`:""}return t}),ae=t=>{const{active:o}=e;return t?a.loop?_(o+t,-1,i.value):_(o+t,0,D.value):o},Y=(t,o=0)=>{let n=t*l.value;a.loop||(n=Math.min(n,-g.value));let v=o-n;return a.loop||(v=_(v,g.value,0)),v},w=({pace:t=0,offset:o=0,emitChange:n})=>{if(i.value<=1)return;const{active:v}=e,c=ae(t),T=Y(c,o);if(a.loop){if(m[0]&&T!==g.value){const O=T<g.value;m[0].setOffset(O?y.value:0)}if(m[i.value-1]&&T!==0){const O=T>0;m[i.value-1].setOffset(O?-y.value:0)}}e.active=c,e.offset=T,n&&c!==v&&C("change",I.value)},$=()=>{e.swiping=!0,e.active<=-1?w({pace:i.value}):e.active>=i.value&&w({pace:-i.value})},ie=()=>{$(),r.reset(),A(()=>{e.swiping=!1,w({pace:-1,emitChange:!0})})},B=()=>{$(),r.reset(),A(()=>{e.swiping=!1,w({pace:1,emitChange:!0})})};let N;const b=()=>clearTimeout(N),S=()=>{b(),a.autoplay>0&&i.value>1&&(N=setTimeout(()=>{B(),S()},+a.autoplay))},p=(t=+a.initialSwipe)=>{if(!u.value)return;const o=()=>{var n,v;if(!W(u)){const c={width:u.value.offsetWidth,height:u.value.offsetHeight};e.rect=c,e.width=+((n=a.width)!=null?n:c.width),e.height=+((v=a.height)!=null?v:c.height)}i.value&&(t=Math.min(i.value-1,t)),e.active=t,e.swiping=!0,e.offset=Y(t),m.forEach(c=>{c.setOffset(0)}),S()};W(u)?F().then(o):o()},X=()=>p(e.active);let H;const ne=t=>{!a.touchable||(r.start(t),H=Date.now(),b(),$())},oe=t=>{a.touchable&&e.swiping&&(r.move(t),R.value&&(!a.loop&&(e.active===0&&s.value>0||e.active===i.value-1&&s.value<0)||(ye(t,a.stopPropagation),w({offset:s.value}))))},K=()=>{if(!a.touchable||!e.swiping)return;const t=Date.now()-H,o=s.value/t;if((Math.abs(o)>.25||Math.abs(s.value)>l.value/2)&&R.value){const v=a.vertical?r.offsetY.value:r.offsetX.value;let c=0;a.loop?c=v>0?s.value>0?-1:1:0:c=-Math[s.value>0?"ceil":"floor"](s.value/l.value),w({pace:c,emitChange:!0})}else s.value&&w({pace:0});e.swiping=!1,S()},se=(t,o={})=>{$(),r.reset(),A(()=>{let n;a.loop&&t===i.value?n=e.active===0?0:t:n=t%i.value,o.immediate?A(()=>{e.swiping=!1}):e.swiping=!1,w({pace:n-e.active,emitChange:!0})})},le=(t,o)=>{const n=o===I.value,v=n?{backgroundColor:a.indicatorColor}:void 0;return P("i",{style:v,class:M("indicator",{active:n})},null)},ce=()=>{if(h.indicator)return h.indicator({active:I.value,total:i.value});if(a.showIndicators&&i.value>1)return P("div",{class:M("indicators",{vertical:a.vertical})},[Array(i.value).fill("").map(le)])};return j({prev:ie,next:B,state:e,resize:X,swipeTo:se}),k({size:l,props:a,count:i,activeIndicator:I}),x(()=>a.initialSwipe,t=>p(+t)),x(i,()=>p(e.active)),x(()=>a.autoplay,S),x([ve,fe],X),x(de(),t=>{t==="visible"?S():b()}),q(p),he(()=>p(e.active)),me(()=>p(e.active)),ge(b),we(b),pe("touchmove",oe,{target:d}),()=>{var t;return P("div",{ref:u,class:M()},[P("div",{ref:d,style:te.value,class:M("track",{vertical:a.vertical}),onTouchstartPassive:ne,onTouchend:K,onTouchcancel:K},[(t=h.default)==null?void 0:t.call(h)]),ce()])}}});const $e=G(Te),[xe,Pe]=J("swipe-item");var Ce=Q({name:xe,setup(a,{slots:C}){let h;const u=U({offset:0,inited:!1,mounted:!1}),{parent:d,index:e}=be(ee);if(!d){console.error("[Vant] <SwipeItem> must be a child component of <Swipe>.");return}const r=f(()=>{const i={},{vertical:l}=d.props;return d.size.value&&(i[l?"height":"width"]=`${d.size.value}px`),u.offset&&(i.transform=`translate${l?"Y":"X"}(${u.offset}px)`),i}),m=f(()=>{const{loop:i,lazyRender:l}=d.props;if(!l||h)return!0;if(!u.mounted)return!1;const s=d.activeIndicator.value,g=d.count.value-1,D=s===0&&i?g:s-1,y=s===g&&i?0:s+1;return h=e.value===s||e.value===D||e.value===y,h}),k=i=>{u.offset=i};return q(()=>{F(()=>{u.mounted=!0})}),j({setOffset:k}),()=>{var i;return P("div",{class:Pe(),style:r.value},[m.value?(i=C.default)==null?void 0:i.call(C):null])}}});const ze=G(Ce);export{ze as S,$e as a};
