import{Q as B,a8 as v,d as W,r as R,m as C,aY as D,a9 as a,ac as E,f as P,g as $,b1 as q,b as i,I,a2 as L,$ as M}from"./index-0001e040.js";const[_,l]=B("notice-bar"),j={text:String,mode:String,color:String,delay:v(1),speed:v(60),leftIcon:String,wrapable:Boolean,background:String,scrollable:{type:Boolean,default:null}};var A=W({name:_,props:j,emits:["close","replay"],setup(e,{emit:h,slots:o}){let f=0,r=0,w;const u=R(),m=R(),t=C({show:!0,offset:0,duration:0}),x=()=>{if(o["left-icon"])return o["left-icon"]();if(e.leftIcon)return i(I,{class:l("left-icon"),name:e.leftIcon},null)},y=()=>{if(e.mode==="closeable")return"cross";if(e.mode==="link")return"arrow"},k=n=>{e.mode==="closeable"&&(t.show=!1,h("close",n))},p=()=>{if(o["right-icon"])return o["right-icon"]();const n=y();if(n)return i(I,{name:n,class:l("right-icon"),onClick:k},null)},N=()=>{t.offset=f,t.duration=0,a.raf(()=>{a.doubleRaf(()=>{t.offset=-r,t.duration=(r+f)/+e.speed,h("replay")})})},S=()=>{const n=e.scrollable===!1&&!e.wrapable,c={transform:t.offset?`translateX(${t.offset}px)`:"",transitionDuration:`${t.duration}s`};return i("div",{ref:u,role:"marquee",class:l("wrap")},[i("div",{ref:m,style:c,class:[l("content"),{"van-ellipsis":n}],onTransitionend:N},[o.default?o.default():e.text])])},s=()=>{const{delay:n,speed:c,scrollable:d}=e,T=L(n)?+n*1e3:0;f=0,r=0,t.offset=0,t.duration=0,clearTimeout(w),w=setTimeout(()=>{if(!u.value||!m.value||d===!1)return;const b=a.useRect(u).width,g=a.useRect(m).width;(d||g>b)&&a.doubleRaf(()=>{f=b,r=g,t.offset=-r,t.duration=r/+c})},T)};return D(s),a.onMountedOrActivated(s),a.useEventListener("pageshow",s),E({reset:s}),P(()=>[e.text,e.scrollable],s),()=>{const{color:n,wrapable:c,background:d}=e;return $(i("div",{role:"alert",class:l({wrapable:c}),style:{color:n,background:d}},[x(),S(),p()]),[[q,t.show]])}}});const Q=M(A);export{Q as N};
