import{_ as K,j as Q,r as b,v as W,i as X,ai as Z,A as ee,l as te,m as oe,o as S,c as I,b as a,w as r,a as p,t as g,u as m,e as j,x as E,n as se,bn as A,al as ne,T as d,I as ae,aP as le,J as ie,K as ue}from"./index-0001e040.js";/* empty css              */import"./index-259473f6.js";import{C as re}from"./index-aebf78fc.js";import"./index-9e9f9536.js";import{F as me}from"./index-a602a0f8.js";import{s as de,b as pe}from"./product.api-19eafb76.js";import{D as ce}from"./index-2e9aec07.js";import{F as ve}from"./index-da87d95b.js";import{D as fe}from"./function-call-75274e81.js";import{B as be}from"./index-3970dd75.js";const O=T=>(ie("data-v-0c38e735"),T=T(),ue(),T),ge={class:"edit-product-pop"},_e={class:"title"},Te={class:"tip pt-2 pb-2 pl-4 pr-4"},ke=O(()=>p("span",null,"%",-1)),ye={class:"tips pt-2 pb-2 pl-4 pr-4"},we={class:"tip pt-2 pb-2 pl-4 pr-4"},xe={class:"tip pt-2 pb-2 pl-4 pr-4"},Ce={class:"tip pt-2 pb-2 pl-4 pr-4"},Ve=O(()=>p("span",null,"%",-1)),$e={style:{margin:"16px"}},he={__name:"editProfit",props:{isEdit:Boolean,productArry:Array},emits:["back","update"],setup(T,{emit:R}){const M=Q();b("true");const{t:n}=W.exports.useI18n(),H=X(),x=b(!1),k=b(!1),y=b(!1),C=b(!1),N=b(new Date),V=b(""),$=b(""),J=b(""),P=R;Z();const L=ee(),o=b({startTime:"",endTime:"",discount:"",percent:""}),h=te(()=>{let e={};return M.userInfo.token?e={...M.userInfo}:L.push("/login"),e}),U=e=>{switch(e){case 1:k.value=!0;break;case 2:y.value=!0;break;case 3:C.value=!0;break}},B=e=>{switch(e){case 1:k.value=!1,o.value.startTime=A(V.value).format("YYYY-MM-DD");break;case 2:y.value=!1,o.value.endTime=A($.value).format("YYYY-MM-DD");break;case 3:C.value=!1,o.value.recTime=z(J.value);break}},F=e=>{switch(e){case 1:k.value=!1;break;case 2:y.value=!1;break;case 3:C.value=!1;break}},G=e=>{const t="production";if([].includes(t)&&(!h.value.phoneverif||!h.value.emailverif)){const u=h.value.phoneverif?"bindEmailTips":"\u8BF7\u7ED1\u5B9A\u624B\u673A\u53F7";fe.confirm({title:n("dialogTips"),message:n(u),cancelButtonText:n("cancel"),confirmButtonText:n("gotoSet"),confirmButtonColor:"#1552F0",cancelButtonColor:"#999"}).then(()=>{ne("/personalInfo")}).catch(()=>{console.log("cancel")});return}const{startTime:v,endTime:f,discount:_}=o.value;if(v||f){const u=new Date(v.replace(/-/g,"/")+" 00:00:00").getTime(),i=new Date(f.replace(/-/g,"/")+" 00:00:00").getTime();if(!_){d(n("\u8BF7\u8BBE\u7F6E\u6298\u6263\u6BD4\u4F8B"));return}if(u>i){d(n("\u5F00\u59CB\u65F6\u95F4\u5E94\u5C0F\u4E8E\u7ED3\u675F\u65F6\u95F4"));return}}if(Number(_)&&(!v||!f)){d(n("\u8BF7\u6B63\u786E\u586B\u5199\u6D3B\u52A8\u5F00\u542F\u65F6\u95F4\u548C\u7ED3\u675F\u65F6\u95F4"));return}let l={goodsIds:D.productArry.join(","),...o.value};if(o.value.percent>c.max||o.value.percent<c.min)d(n("\u767E\u5206\u6BD4\u8BBE\u7F6E\u8303\u56F4\u4E3A")+`\uFF1A${c.min}% ~ ${c.max}%`);else{const u=/^\+?[1-9][0-9]*$/;u.test(String(Number(o.value.percent)))?Number(o.value.discount)&&!u.test(String(Number(o.value.discount)))?d(n("\u6298\u6263\u6BD4\u4F8B\u5FC5\u987B\u4E3A\u6B63\u6574\u6570")):(x.value=!0,l.startTime=l.startTime+" 00:00:00",l.endTime=l.endTime+" 00:00:00",l.profit=(o.value.percent/100).toFixed(2),l.discount=(o.value.discount/100).toFixed(2),l.percent=(o.value.percent/100).toFixed(2),d.loading({forbidClick:!0}),pe(l).then(()=>{d(n("\u4E0A\u67B6\u6210\u529F")),q()}).catch(i=>{const w=typeof i.data=="string"?JSON.parse(i.data):i.data;if(w&&w._$1)d({message:n(i.msg,{_$1:w._$1}),duration:2e3});else if(i.msg.indexOf("\uFF1A")>-1){const s=i.msg.split("\uFF1A");d({message:n(s[0],{num:i.data.noLevelGoodsNum}),duration:2e3})}else d({message:n(i.msg),duration:2e3});x.value=!1})):d(n("\u767E\u5206\u6BD4\u5FC5\u987B\u4E3A\u6B63\u6574\u6570"))}},c=oe({min:5,max:20});de().then(e=>{c.min=Number(e.sysParaMin),c.max=Number(e.sysParaMax)});const q=()=>{Y(),P("update")},D=T,Y=()=>{P("close");for(const e in o.value)o.value[e]="";setTimeout(()=>{x.value=!1},500)},z=e=>{let t=e.getFullYear(),v=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,f=e.getDate()<10?"0"+e.getDate():e.getDate(),_=e.getHours()<10?"0"+e.getHours():e.getHours(),l=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),u=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return t+"-"+v+"-"+f+" "+_+":"+l+":"+u};return(e,t)=>{const v=me,f=re,_=ae,l=ce,u=le,i=be,w=ve;return S(),I("div",{class:se(["editProduct",{"is-ar":m(H)}])},[a(u,{show:D.isEdit,"onUpdate:show":t[16]||(t[16]=s=>D.isEdit=s),round:"",closeable:"",onClickCloseIcon:Y,style:{height:"65%",width:"95%"}},{default:r(()=>[p("div",ge,[p("div",_e,g(m(n)("\u6DFB\u52A0\u5546\u54C1")),1),a(w,null,{default:r(()=>[p("div",Te,g(m(n)("product.25")),1),a(f,{class:"input-field",inset:""},{default:r(()=>[a(v,{modelValue:o.value.percent,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.percent=s),type:"number",placeholder:m(n)("\u767E\u5206\u6BD4"),rules:[{required:!0,message:m(n)("\u8BF7\u586B\u5199\u767E\u5206\u6BD4"),max:c.max,min:c.min}]},{button:r(()=>[ke]),_:1},8,["modelValue","placeholder","rules"])]),_:1}),p("div",ye,[j(g(e.$t("\u5C06\u9009\u4E2D\u7684\u5546\u54C1\u53D1\u5E03\u5230\u4F60\u7684\u5E97\u94FA\uFF0C\u5E76\u586B\u5199\u5546\u54C1\u5229\u6DA6\u6BD4\u4F8B\uFF0C\u63A8\u8350\u6BD4\u4F8B"))+": ",1),p("span",null,g(c.min)+"%-"+g(c.max)+"%",1)]),p("div",we,g(e.$t("\u6298\u6263\u5F00\u59CB\u65E5\u671F")),1),a(f,{class:"input-field",inset:"",style:{position:"relative"}},{default:r(()=>[o.value.startTime?(S(),I("div",{key:0,class:"time-clear",onClick:t[1]||(t[1]=s=>o.value.startTime="")},[a(_,{name:"cross"})])):E("",!0),a(v,{onClickInput:t[2]||(t[2]=s=>U(1)),modelValue:o.value.startTime,"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.startTime=s),placeholder:m(n)("\u6298\u6263\u5F00\u59CB\u65E5\u671F")},null,8,["modelValue","placeholder"]),a(u,{show:k.value,"onUpdate:show":t[7]||(t[7]=s=>k.value=s),round:"",position:"bottom"},{default:r(()=>[a(l,{"min-date":N.value,"cancel-button-text":e.$t("\u53D6\u6D88"),"confirm-button-text":e.$t("\u786E\u5B9A"),modelValue:V.value,"onUpdate:modelValue":t[4]||(t[4]=s=>V.value=s),type:"date",title:m(n)("\u9009\u62E9\u5B8C\u6574\u65F6\u95F4"),onConfirm:t[5]||(t[5]=s=>B(1)),onCancel:t[6]||(t[6]=s=>F(1))},null,8,["min-date","cancel-button-text","confirm-button-text","modelValue","title"])]),_:1},8,["show"])]),_:1}),p("div",xe,g(e.$t("\u6298\u6263\u7ED3\u675F\u65E5\u671F")),1),a(f,{class:"input-field",inset:"",style:{position:"relative"}},{default:r(()=>[o.value.endTime?(S(),I("div",{key:0,class:"time-clear",onClick:t[8]||(t[8]=s=>o.value.endTime="")},[a(_,{name:"cross"})])):E("",!0),a(v,{onClickInput:t[9]||(t[9]=s=>U(2)),modelValue:o.value.endTime,"onUpdate:modelValue":t[10]||(t[10]=s=>o.value.endTime=s),placeholder:m(n)("\u6298\u6263\u7ED3\u675F\u65E5\u671F")},null,8,["modelValue","placeholder"])]),_:1}),p("div",Ce,g(e.$t("\u6298\u6263\u6BD4\u4F8B")),1),a(f,{class:"input-field",inset:""},{default:r(()=>[a(v,{modelValue:o.value.discount,"onUpdate:modelValue":t[11]||(t[11]=s=>o.value.discount=s),type:"number",placeholder:m(n)("\u6298\u6263\u6BD4\u4F8B")},{button:r(()=>[Ve]),_:1},8,["modelValue","placeholder"])]),_:1}),a(u,{show:y.value,"onUpdate:show":t[15]||(t[15]=s=>y.value=s),round:"",position:"bottom"},{default:r(()=>[a(l,{"min-date":N.value,"cancel-button-text":e.$t("\u53D6\u6D88"),"confirm-button-text":e.$t("\u786E\u5B9A"),modelValue:$.value,"onUpdate:modelValue":t[12]||(t[12]=s=>$.value=s),type:"date",title:m(n)("\u9009\u62E9\u5B8C\u6574\u65F6\u95F4"),onConfirm:t[13]||(t[13]=s=>B(2)),onCancel:t[14]||(t[14]=s=>F(2))},null,8,["min-date","cancel-button-text","confirm-button-text","modelValue","title"])]),_:1},8,["show"]),p("div",$e,[a(i,{disabled:x.value,block:"",class:"btn-content",type:"primary",onClick:G,"native-type":"submit"},{default:r(()=>[j(g(m(n)("product.26")),1)]),_:1},8,["disabled"])])]),_:1})])]),_:1},8,["show"])],2)}}},Ee=K(he,[["__scopeId","data-v-0c38e735"]]);export{Ee as e};
