import{_ as Q,i as K,r as b,v as W,a0 as X,$ as Z,k as ee,H as te,l as oe,o as I,c as M,b as a,w as r,a as p,t as g,u as d,e as j,q as C,n as ne,bo as H,am as se,T as m,I as ae,aQ as le,C as ie,D as ue}from"./index-754777e9.js";/* empty css              */import"./index-8b10c6ce.js";import{C as re}from"./index-450e98dc.js";import"./index-3cc9e254.js";import{F as de}from"./index-b450e8d5.js";import{s as me,b as pe}from"./product.api-954632e9.js";import{D as ce}from"./index-48e2f1dc.js";import{F as ve}from"./index-7ab10f44.js";import{D as fe}from"./function-call-865b2be2.js";import{B as be}from"./index-7c758373.js";const A=T=>(ie("data-v-9e40474f"),T=T(),ue(),T),ge={class:"edit-product-pop"},_e={class:"title"},Te={class:"tip pt-2 pb-2 pl-4 pr-4"},ke=A(()=>p("span",null,"%",-1)),we={class:"tips pt-2 pb-2 pl-4 pr-4"},ye={class:"tip pt-2 pb-2 pl-4 pr-4"},xe={class:"tip pt-2 pb-2 pl-4 pr-4"},Ce={class:"tip pt-2 pb-2 pl-4 pr-4"},he=A(()=>p("span",null,"%",-1)),$e={style:{margin:"16px"}},Ve={__name:"editProfit",props:{isEdit:Boolean,productArry:Array},emits:["back","update"],setup(T,{emit:O}){const N=K();b("true");const{t:s}=W.exports.useI18n(),R=X(),x=b(!1),k=b(!1),w=b(!1),h=b(!1),P=b(new Date),$=b(""),V=b(""),L=b(""),U=O;Z();const q=ee(),o=b({startTime:"",endTime:"",discount:"",percent:""}),D=te(()=>{let e={};return N.userInfo.token?e={...N.userInfo}:q.push("/login"),e}),B=e=>{switch(e){case 1:k.value=!0;break;case 2:w.value=!0;break;case 3:h.value=!0;break}},F=e=>{switch(e){case 1:k.value=!1,o.value.startTime=H($.value).format("YYYY-MM-DD");break;case 2:w.value=!1,o.value.endTime=H(V.value).format("YYYY-MM-DD");break;case 3:h.value=!1,o.value.recTime=z(L.value);break}},Y=e=>{switch(e){case 1:k.value=!1;break;case 2:w.value=!1;break;case 3:h.value=!1;break}},G=e=>{const t="tiktokMall";if([].includes(t)&&(!D.value.phoneverif||!D.value.emailverif)){const u=D.value.phoneverif?"bindEmailTips":"\u8BF7\u7ED1\u5B9A\u624B\u673A\u53F7";fe.confirm({title:s("dialogTips"),message:s(u),cancelButtonText:s("cancel"),confirmButtonText:s("gotoSet"),confirmButtonColor:"#1552F0",cancelButtonColor:"#999"}).then(()=>{se("/personalInfo")}).catch(()=>{console.log("cancel")});return}const{startTime:v,endTime:f,discount:_}=o.value;if(v||f){const u=new Date(v.replace(/-/g,"/")+" 00:00:00").getTime(),i=new Date(f.replace(/-/g,"/")+" 00:00:00").getTime();if(!_){m(s("\u8BF7\u8BBE\u7F6E\u6298\u6263\u6BD4\u4F8B"));return}if(u>i){m(s("\u5F00\u59CB\u65F6\u95F4\u5E94\u5C0F\u4E8E\u7ED3\u675F\u65F6\u95F4"));return}}if(Number(_)&&(!v||!f)){m(s("\u8BF7\u6B63\u786E\u586B\u5199\u6D3B\u52A8\u5F00\u542F\u65F6\u95F4\u548C\u7ED3\u675F\u65F6\u95F4"));return}let l={goodsIds:S.productArry.join(","),...o.value};if(o.value.percent>c.max||o.value.percent<c.min)m(s("\u767E\u5206\u6BD4\u8BBE\u7F6E\u8303\u56F4\u4E3A")+`\uFF1A${c.min}% ~ ${c.max}%`);else{const u=/^\+?[1-9][0-9]*$/;u.test(String(Number(o.value.percent)))?Number(o.value.discount)&&!u.test(String(Number(o.value.discount)))?m(s("\u6298\u6263\u6BD4\u4F8B\u5FC5\u987B\u4E3A\u6B63\u6574\u6570")):(x.value=!0,l.startTime=l.startTime+" 00:00:00",l.endTime=l.endTime+" 00:00:00",l.profit=(o.value.percent/100).toFixed(2),l.discount=(o.value.discount/100).toFixed(2),l.percent=(o.value.percent/100).toFixed(2),m.loading({forbidClick:!0}),pe(l).then(()=>{m(s("\u4E0A\u67B6\u6210\u529F")),J()}).catch(i=>{const y=typeof i.data=="string"?JSON.parse(i.data):i.data;if(y&&y._$1)m({message:s(i.msg,{_$1:y._$1}),duration:2e3});else if(i.msg.indexOf("\uFF1A")>-1){const n=i.msg.split("\uFF1A");m({message:s(n[0],{num:i.data.noLevelGoodsNum}),duration:2e3})}else m({message:s(i.msg),duration:2e3});x.value=!1})):m(s("\u767E\u5206\u6BD4\u5FC5\u987B\u4E3A\u6B63\u6574\u6570"))}},c=oe({min:5,max:20});me().then(e=>{c.min=Number(e.sysParaMin),c.max=Number(e.sysParaMax)});const J=()=>{E(),U("update")},S=T,E=()=>{U("close");for(const e in o.value)o.value[e]="";setTimeout(()=>{x.value=!1},500)},z=e=>{let t=e.getFullYear(),v=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,f=e.getDate()<10?"0"+e.getDate():e.getDate(),_=e.getHours()<10?"0"+e.getHours():e.getHours(),l=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),u=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return t+"-"+v+"-"+f+" "+_+":"+l+":"+u};return(e,t)=>{const v=de,f=re,_=ae,l=ce,u=le,i=be,y=ve;return I(),M("div",{class:ne(["editProduct",{"is-ar":d(R)}])},[a(u,{show:S.isEdit,"onUpdate:show":t[16]||(t[16]=n=>S.isEdit=n),round:"",closeable:"",onClickCloseIcon:E,style:{height:"65%",width:"95%"}},{default:r(()=>[p("div",ge,[p("div",_e,g(d(s)("\u6DFB\u52A0\u5546\u54C1")),1),a(y,null,{default:r(()=>[p("div",Te,g(d(s)("product.25")),1),a(f,{class:"input-field",inset:""},{default:r(()=>[a(v,{modelValue:o.value.percent,"onUpdate:modelValue":t[0]||(t[0]=n=>o.value.percent=n),type:"number",placeholder:d(s)("\u767E\u5206\u6BD4"),rules:[{required:!0,message:d(s)("\u8BF7\u586B\u5199\u767E\u5206\u6BD4"),max:c.max,min:c.min}]},{button:r(()=>[ke]),_:1},8,["modelValue","placeholder","rules"])]),_:1}),p("div",we,[j(g(e.$t("\u5C06\u9009\u4E2D\u7684\u5546\u54C1\u53D1\u5E03\u5230\u4F60\u7684\u5E97\u94FA\uFF0C\u5E76\u586B\u5199\u5546\u54C1\u5229\u6DA6\u6BD4\u4F8B\uFF0C\u63A8\u8350\u6BD4\u4F8B"))+": ",1),p("span",null,g(c.min)+"%-"+g(c.max)+"%",1)]),p("div",ye,g(e.$t("\u6298\u6263\u5F00\u59CB\u65E5\u671F")),1),a(f,{class:"input-field",inset:"",style:{position:"relative"}},{default:r(()=>[o.value.startTime?(I(),M("div",{key:0,class:"time-clear",onClick:t[1]||(t[1]=n=>o.value.startTime="")},[a(_,{name:"cross"})])):C("v-if",!0),a(v,{onClickInput:t[2]||(t[2]=n=>B(1)),modelValue:o.value.startTime,"onUpdate:modelValue":t[3]||(t[3]=n=>o.value.startTime=n),placeholder:d(s)("\u6298\u6263\u5F00\u59CB\u65E5\u671F")},null,8,["modelValue","placeholder"]),a(u,{show:k.value,"onUpdate:show":t[7]||(t[7]=n=>k.value=n),round:"",position:"bottom"},{default:r(()=>[a(l,{"min-date":P.value,"cancel-button-text":e.$t("\u53D6\u6D88"),"confirm-button-text":e.$t("\u786E\u5B9A"),modelValue:$.value,"onUpdate:modelValue":t[4]||(t[4]=n=>$.value=n),type:"date",title:d(s)("\u9009\u62E9\u5B8C\u6574\u65F6\u95F4"),onConfirm:t[5]||(t[5]=n=>F(1)),onCancel:t[6]||(t[6]=n=>Y(1))},null,8,["min-date","cancel-button-text","confirm-button-text","modelValue","title"])]),_:1},8,["show"])]),_:1}),p("div",xe,g(e.$t("\u6298\u6263\u7ED3\u675F\u65E5\u671F")),1),a(f,{class:"input-field",inset:"",style:{position:"relative"}},{default:r(()=>[o.value.endTime?(I(),M("div",{key:0,class:"time-clear",onClick:t[8]||(t[8]=n=>o.value.endTime="")},[a(_,{name:"cross"})])):C("v-if",!0),a(v,{onClickInput:t[9]||(t[9]=n=>B(2)),modelValue:o.value.endTime,"onUpdate:modelValue":t[10]||(t[10]=n=>o.value.endTime=n),placeholder:d(s)("\u6298\u6263\u7ED3\u675F\u65E5\u671F")},null,8,["modelValue","placeholder"])]),_:1}),p("div",Ce,g(e.$t("\u6298\u6263\u6BD4\u4F8B")),1),a(f,{class:"input-field",inset:""},{default:r(()=>[a(v,{modelValue:o.value.discount,"onUpdate:modelValue":t[11]||(t[11]=n=>o.value.discount=n),type:"number",placeholder:d(s)("\u6298\u6263\u6BD4\u4F8B")},{button:r(()=>[he]),_:1},8,["modelValue","placeholder"])]),_:1}),a(u,{show:w.value,"onUpdate:show":t[15]||(t[15]=n=>w.value=n),round:"",position:"bottom"},{default:r(()=>[a(l,{"min-date":P.value,"cancel-button-text":e.$t("\u53D6\u6D88"),"confirm-button-text":e.$t("\u786E\u5B9A"),modelValue:V.value,"onUpdate:modelValue":t[12]||(t[12]=n=>V.value=n),type:"date",title:d(s)("\u9009\u62E9\u5B8C\u6574\u65F6\u95F4"),onConfirm:t[13]||(t[13]=n=>F(2)),onCancel:t[14]||(t[14]=n=>Y(2))},null,8,["min-date","cancel-button-text","confirm-button-text","modelValue","title"])]),_:1},8,["show"]),p("div",$e,[a(i,{disabled:x.value,block:"",class:"btn-content",type:"primary",onClick:G,"native-type":"submit"},{default:r(()=>[j(g(d(s)("product.26")),1)]),_:1},8,["disabled"])])]),_:1})])]),_:1},8,["show"]),C(` <fx-header fixed>
      <template #title>\u7F16\u8F91\u5546\u54C1</template>
    </fx-header> `),C(` <van-popup v-model:show="show" position="bottom">
      <div>
        <van-date-picker v-model="fromData.recTime" title="\u9009\u62E9\u65E5\u671F"   ></van-date-picker>

      </div>
    </van-popup> `)],2)}}},je=Q(Ve,[["__scopeId","data-v-9e40474f"],["__file","/mnt/e/\u7F16\u8BD1\u540E/\u524D\u7AEF/H5-\u5546\u5BB6/src/views/product/components/editProfit.vue"]]);export{je as e};
