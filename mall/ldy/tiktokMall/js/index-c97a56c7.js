import{_ as I,d as E,v as Q,r as v,T as m,z as D,I as M,b8 as V,aA as x,c,b as h,w as S,a as r,F as y,s as H,q as _,b9 as T,ba as N,o as d,e as F,t as A,C as X,D as q}from"./index-754777e9.js";/* empty css              */import{S as z,a as u}from"./index-2a1a986b.js";import{u as Y}from"./upload.api-93fc5aaf.js";import{B as J}from"./index-7c758373.js";const j=E({name:"ShopBanner",components:{VuePictureCropper:z},setup(){const{t:e}=Q.exports.useI18n(),U=v(localStorage.getItem("sellerId")||""),w=new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABYCAYAAABxlTA0AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAThSURBVHgB7ZxdTttaEMeHDyFEQMoOrnfQsIJrVgCR+Hy6zgpu7wpIV9DeFeA+QQhS6QpqVkC6gywhL8lLCPQ/xa4QTY5PSjxnWuYnRU7k48T5e3zOnJk5JjIMwzAMwzAUskRKODs7q29sbLxdWVn5i15GNh6Pb05OTvqkABUCn5+fRxD2C95GtBj6k8lkR4PIwQWuQNwCFSIHFbhCcQuCixxMYAFxC4KKHERgQXELgoksLnAAcQuCiCwqcEBxC8RFFhNYgbgFoiKLCKxI3AIxkSsXWKG4BSIizyUwT2drtdrew8PDG4hW9znm/v4+Jn3iFvSXl5czn4a4GANsbo6Ojq5pDrwF7na7b7E5hbhewv7B8EVp7+/vf/Rp7CVwp9NpLy0tnZLxAxjaO1hzu6xdqcCXl5cJNmdk/AS6v/+Oj48/uNosUzlmuTNAV3HK45KzjWvn1dXVHukdoDRQ39ra2nU1cAqMfuZvMpzAu2i49q+6dmrxGHAefQyyfbzlV/3Jq0GBwXk5NXIKHJABRE1x8tfD4fBrq9UazGqIQZjvsgTtY7SPSBnaBM7wah8eHt74HpC3/d4es8aEBx5NQmsReACXpw2X5396AZj2ptikFxcXnDxVMSnycdMqBSL0MFBsv1Tcp7Bvend3t819NwUmqMCw2nQ0GlUScOHvXFtb28bbuWIHiyZkF3ENS2tRhTSbTR4cm5jq84D5DwUgiAXzrQvvoFJxnwJL5kBVjwIQwoJ5QNtxuV5PgRvGcZBkxu4UXkTphWJLhofRXF1dvZUe+MQtmL2FENld/k0Mpu9IGFGBuWtYpLcwL3nkKyNBpC24TYGRtmIxgdl6EaD2ygJUCbqKDB6FV/+/CMQExp/KSA8pCSHZRaSkBMzyPpMQYm6aK4CDwP7MlFSelZ5F7DoWicmpLtz6+npvPB6TBCICc7zBtR8iJvRrRCXHThWY/WL4130SyNaIdBGSg4oveQC/ckQEhgWrE1gq0vZqLZgeU06VI+VFRKSMslzaoni1ApOQBUu5aREXaDgiaOmsA13JzDzbnNEvgGNFMtJifjB8T/5D2bR9rpCjK1zJ4vqEK5/T7XZjCEwSiM3kkO3dJSVAXLHshmQsIiE9xCSEZCyijqxCTIHJq0UjEkI0Hsy1ChQe0XOQDrjHXBRCgcir9CMSRDwnx6VNvDCGhMl/U/wOCpFVrkPkT/CLvTLLuRv2ohQ/++C80ilEKVWQugh4FI1arfaehMBvsS8dUQBCVvYknU6nPhqNWr41EvOSP0WFM8l7FIigtWmw5D1Y120VfTJ/J777S6iSqYLg1ZWAV4LeLtK7YG+Bq3hIQQW8lvpgHvjeYxLw7zyL/J7DMQZ6XCwZkxK0Vbhzji2F0G285/qFjwcHB9msxtzHbm5uNnDMLi5MonEVqtY1GhE9rrtIIDZ/7nFWhFNPEJK3Eb+4HUfFsI+komPzolXg5zQKAWGt9DuhYZD7ozGBK8YErhinwErT7aooK2BxCixZJPe7gsE3c+33eV4EP28nJmManHTdcTUo7YMnk0nLuoqpDFibskalAvPiEdwGOxpWTSqCDc5rAaWXF4HboMdLr0hREXUgeBb5gZf+siY+B8z93LT80V5vuLYLor+aJ1Dh/34dDof9qmLXhmEYhmEYhmEYhmEYhmF8AwdhLA50cpBqAAAAAElFTkSuQmCC",self.location),t=v([{name:`${e("storeBanner")} 1(1920X300)`,id:"banner1",dataURL:"",blobURL:"",file:"",imgUrl:""},{name:`${e("storeBanner")} 2(1920X300)`,id:"banner2",dataURL:"",blobURL:"",file:"",imgUrl:""},{name:`${e("storeBanner")} 3(1920X300)`,id:"banner3",dataURL:"",blobURL:"",file:"",imgUrl:""}]);m.loading({duration:0,message:e("loading"),forbidClick:!0}),D().then(a=>{t.value[0].dataURL=a.banner1||"",t.value[1].dataURL=a.banner2||"",t.value[2].dataURL=a.banner3||"",m.clear()}).catch(()=>{m.clear()});const p=v(!1),f=v(""),i=v(null),b=(a,n)=>{f.value="",t.value[n].dataURL="",t.value[n].blobURL="",t.value[n].file="",i.value=n;const{files:l}=a.target;if(!l||!l.length)return;const o=l[0],g=new FileReader;g.readAsDataURL(o),g.onload=()=>{f.value=String(g.result),p.value=!0}},C=async()=>{if(!u)return;const a=u.getDataURL(),n=await u.getBlob();if(!n)return;const l=await u.getFile();if(i.value===null)return p.value=!1,!1;t.value[i.value].dataURL=a,t.value[i.value].blobURL=URL.createObjectURL(n),t.value[i.value].file=l,p.value=!1},L=()=>{!u||(u.clear(),u.reset(),p.value=!1)},B=async a=>{for(let n=0;n<a.length;n++)await Y({file:a[n].file,moduleName:a[n].id}).then(l=>{const o=t.value.find(g=>g.id===a[n].id);o.imgUrl=l})},s=v(!1);return{bannerImg:w,bannerData:t,submitLoading:s,isShowModal:p,cropperImage:f,showBtn:U,t:e,selectFile:b,getResult:C,croperBack:L,submitHandle:async()=>{const a=t.value.filter(n=>n.file||n.remove);if(a.length){const n=a.filter(o=>o.file);s.value=!0;try{await B(n)}catch(o){return s.value=!1,!1}const l={};a.forEach(o=>{l[o.id]=o.imgUrl}),T(l).then(()=>{s.value=!1,t.value.map(o=>{o.file="",o.imgUrl="",o.remove=!1}),m.success(e("saveSuc"))}).catch(()=>{s.value=!1})}else m(e("noNeedSub"))},removeHandle:a=>{a.dataURL="",a.imgUrl="",a.blobURL="",a.file="",a.remove=!0}}}}),W=e=>(X("data-v-4732ee21"),e=e(),q(),e),K=W(()=>r("div",{style:{height:"46px"}},null,-1)),G={class:"banner-content"},P={class:"title"},Z={class:"img-content"},O=["onClick"],$=["onChange"],ee=["src"],ae={key:2,class:"default"},ne=["src"],te={class:"submit-btn"},oe={key:0,class:"croper-content-modal"};function se(e,U,w,t,p,f){const i=N,b=M,C=J,L=V,B=x("VuePictureCropper");return d(),c("div",null,[h(i,{fixed:!0},{title:S(()=>[F(A(e.t("bannerSet")),1)]),_:1}),K,r("div",G,[(d(!0),c(y,null,H(e.bannerData,(s,k)=>(d(),c("div",{key:s.id,class:"item"},[r("div",P,A(s.name),1),r("div",Z,[s.dataURL?(d(),c("div",{key:0,class:"close",onClick:R=>e.removeHandle(s)},[h(b,{name:"cross"})],8,O)):_("v-if",!0),r("input",{type:"file",accept:"image/jpg, image/jpeg, image/png, image/gif",onChange:R=>e.selectFile(R,k)},null,40,$),s.dataURL?(d(),c("img",{key:1,src:s.dataURL,alt:""},null,8,ee)):(d(),c("div",ae,[r("img",{src:e.bannerImg,alt:""},null,8,ne),r("p",null,A(e.t("addBanner")),1)]))])]))),128)),r("div",te,[h(C,{loading:e.submitLoading,type:"primary",size:"large",disabled:!e.showBtn,onClick:e.submitHandle},{default:S(()=>[F(A(e.showBtn?e.t("save"):e.t("\u5546\u5BB6\u5165\u9A7B\u5C1A\u672A\u5B8C\u6210")),1)]),_:1},8,["loading","disabled","onClick"])])]),e.isShowModal?(d(),c("div",oe,[h(L,{title:e.t("selectPhotos"),"right-text":e.t("sure"),"left-arrow":"",fixed:"",onClickLeft:e.croperBack,onClickRight:e.getResult},null,8,["title","right-text","onClickLeft","onClickRight"]),h(B,{boxStyle:{width:"100%",height:"100%",backgroundColor:"#f8f8f8",margin:"auto"},img:e.cropperImage,options:{viewMode:1,dragMode:"crop",aspectRatio:1920/300}},null,8,["img"])])):_("v-if",!0)])}const ue=I(j,[["render",se],["__scopeId","data-v-4732ee21"],["__file","/mnt/e/\u7F16\u8BD1\u540E/\u524D\u7AEF/H5-\u5546\u5BB6/src/views/shop/banner/index.vue"]]);export{ue as default};
