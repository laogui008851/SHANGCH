import{P as B,aa as v,d as P,r as R,l as W,aZ as C,ab as a,ae as D,f as E,g as q,b2 as L,b as i,I,a4 as M,Z}from"./index-754777e9.js";const[_,l]=B("notice-bar"),$={text:String,mode:String,color:String,delay:v(1),speed:v(60),leftIcon:String,wrapable:Boolean,background:String,scrollable:{type:Boolean,default:null}};var j=P({name:_,props:$,emits:["close","replay"],setup(e,{emit:h,slots:o}){let f=0,r=0,b;const u=R(),m=R(),t=W({show:!0,offset:0,duration:0}),x=()=>{if(o["left-icon"])return o["left-icon"]();if(e.leftIcon)return i(I,{class:l("left-icon"),name:e.leftIcon},null)},y=()=>{if(e.mode==="closeable")return"cross";if(e.mode==="link")return"arrow"},k=n=>{e.mode==="closeable"&&(t.show=!1,h("close",n))},p=()=>{if(o["right-icon"])return o["right-icon"]();const n=y();if(n)return i(I,{name:n,class:l("right-icon"),onClick:k},null)},N=()=>{t.offset=f,t.duration=0,a.raf(()=>{a.doubleRaf(()=>{t.offset=-r,t.duration=(r+f)/+e.speed,h("replay")})})},S=()=>{const n=e.scrollable===!1&&!e.wrapable,c={transform:t.offset?`translateX(${t.offset}px)`:"",transitionDuration:`${t.duration}s`};return i("div",{ref:u,role:"marquee",class:l("wrap")},[i("div",{ref:m,style:c,class:[l("content"),{"van-ellipsis":n}],onTransitionend:N},[o.default?o.default():e.text])])},s=()=>{const{delay:n,speed:c,scrollable:d}=e,T=M(n)?+n*1e3:0;f=0,r=0,t.offset=0,t.duration=0,clearTimeout(b),b=setTimeout(()=>{if(!u.value||!m.value||d===!1)return;const w=a.useRect(u).width,g=a.useRect(m).width;(d||g>w)&&a.doubleRaf(()=>{f=w,r=g,t.offset=-r,t.duration=r/+c})},T)};return C(s),a.onMountedOrActivated(s),a.useEventListener("pageshow",s),D({reset:s}),E(()=>[e.text,e.scrollable],s),()=>{const{color:n,wrapable:c,background:d}=e;return q(i("div",{role:"alert",class:l({wrapable:c}),style:{color:n,background:d}},[x(),S(),p()]),[[L,t.show]])}}});const O=Z(j);export{O as N};
