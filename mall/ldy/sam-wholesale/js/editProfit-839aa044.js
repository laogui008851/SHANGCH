import{_ as K,j as Q,r as b,v as W,i as X,ai as Z,l as ee,m as te,p as oe,o as I,c as P,b as a,w as r,a as p,t as g,u as d,e as E,y as h,n as se,bz as A,al as ne,T as m,I as ae,aP as le,J as ie,K as ue}from"./index-19a98339.js";/* empty css              */import"./index-f11ba40f.js";import{C as re}from"./index-5e9eac9d.js";import"./index-93160a1b.js";import{F as de}from"./index-0400f7f8.js";import{s as me,a as pe}from"./product.api-d023c191.js";import{D as ce}from"./index-d2ec8f31.js";import{F as ve}from"./index-42044eb9.js";import{D as fe}from"./function-call-5bd25457.js";import{B as be}from"./index-101610a8.js";const H=T=>(ie("data-v-9e40474f"),T=T(),ue(),T),ge={class:"edit-product-pop"},_e={class:"title"},Te={class:"tip pt-2 pb-2 pl-4 pr-4"},ke=H(()=>p("span",null,"%",-1)),we={class:"tips pt-2 pb-2 pl-4 pr-4"},ye={class:"tip pt-2 pb-2 pl-4 pr-4"},xe={class:"tip pt-2 pb-2 pl-4 pr-4"},he={class:"tip pt-2 pb-2 pl-4 pr-4"},Ce=H(()=>p("span",null,"%",-1)),De={style:{margin:"16px"}},Ve={__name:"editProfit",props:{isEdit:Boolean,productArry:Array},emits:["back","update"],setup(T,{emit:O}){const M=Q();b("true");const{t:n}=W.exports.useI18n(),R=X(),x=b(!1),k=b(!1),w=b(!1),C=b(!1),N=b(new Date),D=b(""),V=b(""),J=b(""),U=O;Z();const L=ee(),o=b({startTime:"",endTime:"",discount:"",percent:""}),$=te(()=>{let e={};return M.userInfo.token?e={...M.userInfo}:L.push("/login"),e}),B=e=>{switch(e){case 1:k.value=!0;break;case 2:w.value=!0;break;case 3:C.value=!0;break}},Y=e=>{switch(e){case 1:k.value=!1,o.value.startTime=A(D.value).format("YYYY-MM-DD");break;case 2:w.value=!1,o.value.endTime=A(V.value).format("YYYY-MM-DD");break;case 3:C.value=!1,o.value.recTime=q(J.value);break}},F=e=>{switch(e){case 1:k.value=!1;break;case 2:w.value=!1;break;case 3:C.value=!1;break}},z=e=>{const t="sam-wholesale";if([].includes(t)&&(!$.value.phoneverif||!$.value.emailverif)){const u=$.value.phoneverif?"bindEmailTips":"\u8BF7\u7ED1\u5B9A\u624B\u673A\u53F7";fe.confirm({title:n("dialogTips"),message:n(u),cancelButtonText:n("cancel"),confirmButtonText:n("gotoSet"),confirmButtonColor:"#1552F0",cancelButtonColor:"#999"}).then(()=>{ne("/personalInfo")}).catch(()=>{console.log("cancel")});return}const{startTime:v,endTime:f,discount:_}=o.value;if(v||f){const u=new Date(v.replace(/-/g,"/")+" 00:00:00").getTime(),i=new Date(f.replace(/-/g,"/")+" 00:00:00").getTime();if(!_){m(n("\u8BF7\u8BBE\u7F6E\u6298\u6263\u6BD4\u4F8B"));return}if(u>i){m(n("\u5F00\u59CB\u65F6\u95F4\u5E94\u5C0F\u4E8E\u7ED3\u675F\u65F6\u95F4"));return}}if(Number(_)&&(!v||!f)){m(n("\u8BF7\u6B63\u786E\u586B\u5199\u6D3B\u52A8\u5F00\u542F\u65F6\u95F4\u548C\u7ED3\u675F\u65F6\u95F4"));return}let l={goodsIds:S.productArry.join(","),...o.value};if(o.value.percent>c.max||o.value.percent<c.min)m(n("\u767E\u5206\u6BD4\u8BBE\u7F6E\u8303\u56F4\u4E3A")+`\uFF1A${c.min}% ~ ${c.max}%`);else{const u=/^\+?[1-9][0-9]*$/;u.test(String(Number(o.value.percent)))?Number(o.value.discount)&&!u.test(String(Number(o.value.discount)))?m(n("\u6298\u6263\u6BD4\u4F8B\u5FC5\u987B\u4E3A\u6B63\u6574\u6570")):(x.value=!0,l.startTime=l.startTime+" 00:00:00",l.endTime=l.endTime+" 00:00:00",l.profit=(o.value.percent/100).toFixed(2),l.discount=(o.value.discount/100).toFixed(2),l.percent=(o.value.percent/100).toFixed(2),m.loading({forbidClick:!0}),pe(l).then(()=>{m(n("\u4E0A\u67B6\u6210\u529F")),G()}).catch(i=>{const y=typeof i.data=="string"?JSON.parse(i.data):i.data;if(y&&y._$1)m({message:n(i.msg,{_$1:y._$1}),duration:2e3});else if(i.msg.indexOf("\uFF1A")>-1){const s=i.msg.split("\uFF1A");m({message:n(s[0],{num:i.data.noLevelGoodsNum}),duration:2e3})}else m({message:n(i.msg),duration:2e3});x.value=!1})):m(n("\u767E\u5206\u6BD4\u5FC5\u987B\u4E3A\u6B63\u6574\u6570"))}},c=oe({min:5,max:20});me().then(e=>{c.min=Number(e.sysParaMin),c.max=Number(e.sysParaMax)});const G=()=>{j(),U("update")},S=T,j=()=>{U("close");for(const e in o.value)o.value[e]="";setTimeout(()=>{x.value=!1},500)},q=e=>{let t=e.getFullYear(),v=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,f=e.getDate()<10?"0"+e.getDate():e.getDate(),_=e.getHours()<10?"0"+e.getHours():e.getHours(),l=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),u=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return t+"-"+v+"-"+f+" "+_+":"+l+":"+u};return(e,t)=>{const v=de,f=re,_=ae,l=ce,u=le,i=be,y=ve;return I(),P("div",{class:se(["editProduct",{"is-ar":d(R)}])},[a(u,{show:S.isEdit,"onUpdate:show":t[16]||(t[16]=s=>S.isEdit=s),round:"",closeable:"",onClickCloseIcon:j,style:{height:"65%",width:"95%"}},{default:r(()=>[p("div",ge,[p("div",_e,g(d(n)("\u6DFB\u52A0\u5546\u54C1")),1),a(y,null,{default:r(()=>[p("div",Te,g(d(n)("product.25")),1),a(f,{class:"input-field",inset:""},{default:r(()=>[a(v,{modelValue:o.value.percent,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.percent=s),type:"number",placeholder:d(n)("\u767E\u5206\u6BD4"),rules:[{required:!0,message:d(n)("\u8BF7\u586B\u5199\u767E\u5206\u6BD4"),max:c.max,min:c.min}]},{button:r(()=>[ke]),_:1},8,["modelValue","placeholder","rules"])]),_:1}),p("div",we,[E(g(e.$t("\u5C06\u9009\u4E2D\u7684\u5546\u54C1\u53D1\u5E03\u5230\u4F60\u7684\u5E97\u94FA\uFF0C\u5E76\u586B\u5199\u5546\u54C1\u5229\u6DA6\u6BD4\u4F8B\uFF0C\u63A8\u8350\u6BD4\u4F8B"))+": ",1),p("span",null,g(c.min)+"%-"+g(c.max)+"%",1)]),p("div",ye,g(e.$t("\u6298\u6263\u5F00\u59CB\u65E5\u671F")),1),a(f,{class:"input-field",inset:"",style:{position:"relative"}},{default:r(()=>[o.value.startTime?(I(),P("div",{key:0,class:"time-clear",onClick:t[1]||(t[1]=s=>o.value.startTime="")},[a(_,{name:"cross"})])):h("v-if",!0),a(v,{onClickInput:t[2]||(t[2]=s=>B(1)),modelValue:o.value.startTime,"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.startTime=s),placeholder:d(n)("\u6298\u6263\u5F00\u59CB\u65E5\u671F")},null,8,["modelValue","placeholder"]),a(u,{show:k.value,"onUpdate:show":t[7]||(t[7]=s=>k.value=s),round:"",position:"bottom"},{default:r(()=>[a(l,{"min-date":N.value,"cancel-button-text":e.$t("\u53D6\u6D88"),"confirm-button-text":e.$t("\u786E\u5B9A"),modelValue:D.value,"onUpdate:modelValue":t[4]||(t[4]=s=>D.value=s),type:"date",title:d(n)("\u9009\u62E9\u5B8C\u6574\u65F6\u95F4"),onConfirm:t[5]||(t[5]=s=>Y(1)),onCancel:t[6]||(t[6]=s=>F(1))},null,8,["min-date","cancel-button-text","confirm-button-text","modelValue","title"])]),_:1},8,["show"])]),_:1}),p("div",xe,g(e.$t("\u6298\u6263\u7ED3\u675F\u65E5\u671F")),1),a(f,{class:"input-field",inset:"",style:{position:"relative"}},{default:r(()=>[o.value.endTime?(I(),P("div",{key:0,class:"time-clear",onClick:t[8]||(t[8]=s=>o.value.endTime="")},[a(_,{name:"cross"})])):h("v-if",!0),a(v,{onClickInput:t[9]||(t[9]=s=>B(2)),modelValue:o.value.endTime,"onUpdate:modelValue":t[10]||(t[10]=s=>o.value.endTime=s),placeholder:d(n)("\u6298\u6263\u7ED3\u675F\u65E5\u671F")},null,8,["modelValue","placeholder"])]),_:1}),p("div",he,g(e.$t("\u6298\u6263\u6BD4\u4F8B")),1),a(f,{class:"input-field",inset:""},{default:r(()=>[a(v,{modelValue:o.value.discount,"onUpdate:modelValue":t[11]||(t[11]=s=>o.value.discount=s),type:"number",placeholder:d(n)("\u6298\u6263\u6BD4\u4F8B")},{button:r(()=>[Ce]),_:1},8,["modelValue","placeholder"])]),_:1}),a(u,{show:w.value,"onUpdate:show":t[15]||(t[15]=s=>w.value=s),round:"",position:"bottom"},{default:r(()=>[a(l,{"min-date":N.value,"cancel-button-text":e.$t("\u53D6\u6D88"),"confirm-button-text":e.$t("\u786E\u5B9A"),modelValue:V.value,"onUpdate:modelValue":t[12]||(t[12]=s=>V.value=s),type:"date",title:d(n)("\u9009\u62E9\u5B8C\u6574\u65F6\u95F4"),onConfirm:t[13]||(t[13]=s=>Y(2)),onCancel:t[14]||(t[14]=s=>F(2))},null,8,["min-date","cancel-button-text","confirm-button-text","modelValue","title"])]),_:1},8,["show"]),p("div",De,[a(i,{disabled:x.value,block:"",class:"btn-content",type:"primary",onClick:z,"native-type":"submit"},{default:r(()=>[E(g(d(n)("product.26")),1)]),_:1},8,["disabled"])])]),_:1})])]),_:1},8,["show"]),h(` <fx-header fixed>
      <template #title>\u7F16\u8F91\u5546\u54C1</template>
    </fx-header> `),h(` <van-popup v-model:show="show" position="bottom">
      <div>
        <van-date-picker v-model="fromData.recTime" title="\u9009\u62E9\u65E5\u671F"   ></van-date-picker>

      </div>
    </van-popup> `)],2)}}},Ee=K(Ve,[["__scopeId","data-v-9e40474f"],["__file","C:/Users/DIY/Desktop/\u6E90\u7801/H5-\u5546\u5BB6/src/views/product/components/editProfit.vue"]]);export{Ee as e};
