"use strict";(self["webpackChunkshop"]=self["webpackChunkshop"]||[]).push([[3006],{18671:function(t,s,i){i.r(s),i.d(s,{default:function(){return I}});var e,a=function(){var t=this,s=t._self._c;return s("div",{staticClass:"search-container"},[s("van-nav-bar",{attrs:{"safe-area-inset-top":"",fixed:"","left-arrow":"","right-text":t.$t("搜索")},on:{"click-right":t.searchHandle,"click-left":function(s){return t.$router.go(-1)}},scopedSlots:t._u([{key:"title",fn:function(){return[s("van-search",{attrs:{shape:"round",clearable:!1,placeholder:t.$t("搜索店铺内商品")},scopedSlots:t._u([{key:"left-icon",fn:function(){return[s("img",{staticClass:"search-icon",attrs:{src:t.searchIcon,alt:""},on:{click:t.inputHandle}})]},proxy:!0},{key:"right-icon",fn:function(){return[t.keyword?s("van-icon",{attrs:{name:"cross",size:"14",color:"#333333"},on:{click:t.clearHandle}}):t._e()]},proxy:!0}]),model:{value:t.keyword,callback:function(s){t.keyword=s},expression:"keyword"}})]},proxy:!0}])}),s("div",{staticStyle:{width:"100%",height:"44px"}}),t.tipsShow||t.shopShow||t.listShow?t._e():s("div",{staticClass:"search-history"},[s("div",{staticClass:"title"},[s("p",[t._v(t._s(t.$t("历史搜索")))]),t.searchHistory2.length?s("div",{staticClass:"clear",on:{click:t.emptyHandle}},[s("img",{staticClass:"search-icon",attrs:{src:t.clearIcon,alt:""}}),s("p",[t._v(t._s(t.$t("清空")))])]):t._e()]),t.searchHistory2.length?s("div",{staticClass:"content"},t._l(t.searchHistory2,(function(i,e){return s("div",{key:e,staticClass:"item",on:{click:function(s){return t.tipsHandle(i,!1)}}},[t._v(" "+t._s(i)+" ")])})),0):s("van-empty",{attrs:{description:t.$t("暂无记录")}})],1),t.tipsShow?s("div",{staticClass:"search-result-content"},[s("van-list",{attrs:{finished:t.finished,"loading-text":t.$t("加载中")},on:{load:t.onLoad},model:{value:t.loading,callback:function(s){t.loading=s},expression:"loading"}},[s("div",{staticStyle:{padding:"0 15px"}},[s("goods-content-one",{attrs:{"goods-data":t.tipsData}}),t.tipsData.length||t.listLoading||t.loading?t._e():s("van-empty",{attrs:{description:t.$t("暂无数据")}})],1)])],1):t._e(),t.isEmpty?s("van-empty",{attrs:{description:t.$t("暂无记录")}}):t._e(),t.shopShow?s("div",{staticClass:"shop-list-content"},["en"===t.activeLang?s("div",{staticClass:"tips"},[t._v(" Find "+t._s(t.shopData.length)+" "),s("span",[t._v('"'+t._s(t.keyword))]),t._v('" related stores for you ')]):s("div",{staticClass:"tips"},[t._v(" "+t._s(t.$t("为您找到"))+" "),s("span",[t._v('"'+t._s(t.keyword))]),t._v('" '+t._s(t.$t("相关的店铺"))+" "+t._s(t.shopData.length||0)+" "+t._s(t.$t("家"))+" ")]),s("shop-content-two",{attrs:{"shop-data":t.shopData}})],1):t._e()],1)},o=[],n=i(23698),r=i(86080),h=i(54503),c=(i(55601),i(10521)),l=(i(69197),i(59553)),d=(i(76418),i(28490)),p=(i(46803),i(50644)),u=(i(45187),i(30242)),g=(i(95436),i(6943)),f=(i(34284),i(60228),i(19649),i(21694),i(76265),i(34338),i(28436),i(48324),i(51894)),y=i(55884),m=i(90408),w=i(12773),v=i.n(w),S=i(79717),Z=i(81273),k={name:"Search",components:(e={},(0,h.Z)(e,g.Z.name,g.Z),(0,h.Z)(e,u.Z.name,u.Z),(0,h.Z)(e,p.Z.name,p.Z),(0,h.Z)(e,d.Z.name,d.Z),(0,h.Z)(e,l.Z.name,l.Z),(0,h.Z)(e,c.Z.name,c.Z),(0,h.Z)(e,"GoodsContentOne",f.Z),(0,h.Z)(e,"ShopContentTwo",y.Z),e),data:function(){return{searchIcon:i(70452),clearIcon:i(50334),keyword:"",tipsShow:!1,tipsData:[],shopData:[],shopShow:!1,listData:[],listShow:!1,listLoading:!1,loading:!1,finished:!1,refreshing:!1,pageNum:1,pageSize:20,currentGoodsId:null,searchHistory2:[],isEmpty:!1}},computed:(0,r.Z)({},(0,m.Se)({searchHistory:"searchHistory",activeLang:"language"})),beforeRouteLeave:function(t,s,i){s.meta.keepAlive=Boolean("CommodityDetails"===t.name),i()},mounted:function(){this.searchHistory2=JSON.parse(localStorage.getItem(this.$route.query.sellerId))||[],this.searchHistory2=(0,n.Z)(new Set(this.searchHistory2)),this.tipsData=[]},methods:{onRefresh:function(){this.finished=!1,this.pageNum=1,this.loading=!0,this.onLoad()},onLoad:function(){this.refreshing&&(this.list=[],this.refreshing=!1),this.getListData()},getListData:function(){var t=this;this.currentGoodsId?(0,S.lr)({goodsId:this.currentGoodsId,pageNum:this.pageNum,pageSize:this.pageSize}).then((function(s){var i=s.pageList;t.listData=1===t.pageNum?i:[].concat((0,n.Z)(t.listData),(0,n.Z)(i)),t.pageNum++,t.loading=!1,i.length<t.pageSize&&(t.finished=!0),t.listLoading=!1,c.Z.clear()}))["catch"]((function(){t.loading=!1,t.listLoading=!1,c.Z.clear()})):(this.listLoading=!1,this.finished=!0,c.Z.clear(),this.listData=[])},tipsHandle:function(t,s){var i=this;if("string"==typeof t)return this.keyword=t,void this.searchHandle();s?(this.shopShow=!0,this.tipsShow=!1,this.listShow=!1,(0,S.HH)({keyword:this.keyword,isHot:"0",isPrice:"0",isNew:"0"}).then((function(t){Z.log("res ->",t),i.shopData=t.sellerList}))):(this.listShow=!0,this.tipsShow=!1,this.shopShow=!1,this.keyword=t.name,this.currentGoodsId=t.goodsId,this.$store.dispatch("setSearchHistory",{name:t.name,goodsId:t.goodsId}),c.Z.loading({duration:0,message:this.$t("加载中")}),this.pageNum=1,this.finished=!1,this.loading=!0,this.listLoading=!0,this.refreshing=!0,this.listData=[],this.onLoad())},clearHandle:function(){this.tipsShow=!1,this.listShow=!1,this.shopShow=!1,this.keyword=""},inputHandle:v()((function(){this.searchHandle()}),200),searchHandle:function(){var t=this,s=String(this.keyword).trim();if(""==s)return(0,c.Z)(this.$t("请输入搜索内容"));this.tipsShow=!0,this.listShow=!1,this.shopShow=!1,s?(this.searchHistory2.push(s),this.searchHistory2=(0,n.Z)(new Set(this.searchHistory2)),localStorage.setItem(this.$route.query.sellerId,JSON.stringify(this.searchHistory2)),(0,S.Lq)({keyword:s,sellerId:this.$route.query.sellerId}).then((function(i){var e=i.pageList;i.pageInfo;if(!e.length)return(0,c.Z)("".concat(t.$t("未找到与")).concat(s).concat(t.$t("相关的商品"))),void(t.isEmpty=!0);t.isEmpty=!1,t.listData=e,t.tipsData=(0,n.Z)(e)}))["catch"]((function(t){}))):(this.tipsShow=!1,this.listShow=!1,this.shopShow=!1)},emptyHandle:function(){this.$store.dispatch("clearSearchHistory"),localStorage.removeItem(this.$route.query.sellerId),this.searchHistory2=[]}}},H=k,_=i(1001),$=(0,_.Z)(H,a,o,!1,null,"38175fd2",null),I=$.exports}}]);