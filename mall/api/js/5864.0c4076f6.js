"use strict";(self["webpackChunkshop"]=self["webpackChunkshop"]||[]).push([[5864],{5864:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var r,i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bank_card"},[t("van-nav-bar",{attrs:{"safe-area-inset-top":"",fixed:"",title:"Hive"==e.itemName?e.$t("加值"):e.$t("充值"),"left-arrow":"","right-text":e.$t("记录")},on:{"click-left":function(t){return e.$router.push({path:"/rechargeList",dir:"left"})},"click-right":function(t){return e.$router.push({path:"/rechargeRecord"})}}}),t("div",{staticClass:"h46",staticStyle:{width:"100%"}}),t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[e.isGcash?e._e():t("el-form-item",{attrs:{label:e.$t("选择币种")}},[t("el-select",{attrs:{placeholder:e.$t("请选择币种"),filterable:"","no-match-text":e.$t("无匹配数据")},on:{change:e.handleChange},model:{value:e.form.currency,callback:function(t){e.$set(e.form,"currency",t)},expression:"form.currency"}},e._l(e.coinList,(function(e){return t("el-option",{key:e.bank_code,attrs:{label:e.bank_code,value:e.bank_code}})})),1)],1),t("el-form-item",{attrs:{label:e.$t("充值金额")}},[t("el-input",{attrs:{type:"number",step:"0.01",placeholder:"".concat(e.min,"-").concat(e.max),clearable:""},on:{input:e.handleInput,change:e.handleInputChange},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1)],1),t("div",{staticClass:"btn"},[t("van-button",{attrs:{block:"",type:"primary",disabled:e.btnDis},on:{click:e.onSubmit}},[e._v(e._s(e.$t("确认")))])],1),t("van-popup",{model:{value:e.showPopup,callback:function(t){e.showPopup=t},expression:"showPopup"}},[t("div",{staticClass:"popup_wrap"},[t("div",{staticClass:"title"},[e._v(" "+e._s(e.$t("请前往"))+e._s(e.payName)+"，"+e._s(e.$t("继续完成支付"))+" ")]),t("div",{staticClass:"path"},[e._v(" "+e._s(e.path)+" ")]),t("div",{staticClass:"btn"},[t("van-button",{attrs:{type:"primary"},on:{click:e.handleAccess}},[e._v(e._s(e.$t("继续访问")))])],1)])])],1)},a=[],s=n(50124),o=n(48534),c=n(82482),u=(n(60836),n(46811)),p=(n(37850),n(88848)),l=(n(57267),n(90925)),h=n(14970),m={components:(r={},(0,c.Z)(r,p.Z.name,p.Z),(0,c.Z)(r,u.Z.name,u.Z),r),data:function(){return{itemName:"SM-wholesaleShop",coinList:[],max:"",min:"",form:{currency:"",price:""},session_token:"",btnDis:!0,isGcash:!0,showPopup:!1,path:""}},computed:{payName:function(){var e;return"Maya"==(null===(e=this.$route.query)||void 0===e?void 0:e.type)?"Maya":"GCash"}},created:function(){var e=this;return(0,o.Z)((0,s.Z)().mark((function t(){var n,r,i,a,o;return(0,s.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if((0,h.BX)({}).then((function(t){e.session_token=t.session_token})),n=e.$route.query,r=n.type,i=n.min,a=n.max,e.isGcash="Bank"!=r,"Bank"!=r){t.next=22;break}return p.Z.loading({message:e.$t("加载中..."),forbidClick:!0,duration:0}),t.prev=5,t.next=8,(0,l.SZ)();case 8:o=t.sent,e.coinList=o.filter((function(e){return e.productType==r}))[0].range,e.form.currency=e.coinList[27].bank_code,e.max=e.coinList[27].max_amount,e.min=e.coinList[27].min_amount,p.Z.clear(),t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](5),p.Z.clear(),e.$router.back();case 20:t.next=24;break;case 22:e.max=a,e.min=i;case 24:case"end":return t.stop()}}),t,null,[[5,16]])})))()},methods:{onSubmit:function(){var e=this;return(0,o.Z)((0,s.Z)().mark((function t(){var n,r,i,a,o,c,u,p,m;return(0,s.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$toast.loading(),""!=e.form.price){t.next=3;break}return t.abrupt("return",e.$notify(e.$t("请输入充值数量")));case 3:return t.next=5,(0,h.BX)({}).then((function(t){e.session_token=t.session_token}));case 5:if(!e.isGcash){t.next=16;break}return a={"GCash2.0":l.OQ,"GCash3.0":l.eL,Maya:l._2,"GCash pay":l.mx},o=a[null===(n=e.$route.query)||void 0===n?void 0:n.type]||l.V$,c={amount:e.form.price,session_token:e.session_token,token:localStorage.getItem("token")},["GCash2.0","GCash3.0","Maya","GCash pay"].includes(null===(r=e.$route.query)||void 0===r?void 0:r.type)&&(c.pageUrl=window.location.href.split("#/")[0]+"#/me"),t.next=12,o(c);case 12:u=t.sent,null!==(i=window)&&void 0!==i&&i.plus?plus.runtime.openURL(u):e.isIos()?(e.path=u,e.showPopup=!0):window.open(u),t.next=20;break;case 16:return t.next=18,(0,l.J$)({amount:e.form.price,frenchCurrency:e.form.currency,session_token:e.session_token});case 18:m=t.sent,null!==(p=window)&&void 0!==p&&p.plus?plus.runtime.openURL(m):e.isIos()?(e.path=m,e.showPopup=!0):window.open(m);case 20:e.$toast.clear();case 21:case"end":return t.stop()}}),t)})))()},isIos:function(){var e=navigator.userAgent;return!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)},handleChange:function(e){this.form.price="";var t=this.coinList.filter((function(t){return t.bank_code==e}));this.max=t[0].max_amount,this.min=t[0].min_amount},handleInput:function(){this.form.price=this.form.price.replace(/[^\d.]/g,""),this.form.price=this.form.price.replace(/\.{2,}/g,"."),this.form.price=this.form.price.replace(/^\./g,""),this.form.price=this.form.price.replace(".","$#$").replace(/\./g,"").replace("$#$","."),this.form.price=this.form.price.replace(/^(\-)*(\d+)\.(\d{0,2}).*$/,"$1$2.$3"),this.form.price>this.max?this.form.price=this.max:this.form.price<1&&(this.form.price=""),this.btnDis=this.form.price<this.min},handleInputChange:function(){if(this.form.price<this.min)return this.form.price="",void this.$notify("".concat(this.$t("申请金额不能小于")).concat(this.min));this.form.price=Number(this.form.price).toFixed(2)},handleGcashQuery:function(e){return(0,o.Z)((0,s.Z)().mark((function t(){var n;return(0,s.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,l.SZ)(e);case 2:return n=t.sent,t.abrupt("return",n[0]);case 4:case"end":return t.stop()}}),t)})))()},handleAccess:function(){this.showPopup=!1,window.open(this.path)}}},f=m,d=n(1001),v=(0,d.Z)(f,i,a,!1,null,"57a7f7c6",null),k=v.exports},60836:function(e,t,n){n(22184),n(74048),n(14106),n(4127),n(44174)}}]);